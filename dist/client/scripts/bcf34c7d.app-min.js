"use strict";RegExp.prototype.toJSON=function(){return this.source},Object.haveEqualData=function(a,b){return a?b?JSON.stringify(a)===JSON.stringify(b):!1:!b},Object.isEmpty=function(a){return 0===Object.keys(a).length},Object.copyKeys=function(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])},Object.clone=function(a){return JSON.parse(JSON.stringify(a))},Array.prototype.add=function(a){return-1===this.indexOf(a)?(this.push(a),!0):!1},Array.prototype.replace=function(a,b){var c=this.indexOf(a);return c>-1?(this.splice(c,1),this.splice(c,0,b),!0):!1},Array.prototype.remove=function(a){var b=this.indexOf(a);return b>-1?(this.splice(b,1),!0):!1},Array.prototype.contains=function(a){var b=this.indexOf(a);return b>-1},Array.prototype.createCopy=function(){if(!this)return null;for(var a=[],b=0;b<this.length;b++)a.push(this[b]);return a},Array.prototype.where=function(a){if(!this||!this.length)return this;for(var b=[],c=0;c<this.length;c++)a(this[c])&&b.push(this[c]);return b},Array.prototype.single=function(a){var b=this.where(a);return 1===b.length?b[0]:null},Array.prototype.first=function(a){if(!this||!this.length)return this;for(var b=0;b<this.length;b++)if(a(this[b]))return this[b];return null},Array.prototype.any=function(a){return this.where(a).length>0},Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);this.splice(b,0,this.splice(a,1)[0])},String.prototype.format=function(a){var b=new RegExp("{(\\d+)}","g");return this.replace(b,function(b,c){return"undefined"!=typeof arguments?a[c]:b})},String.prototype.startsWith=function(a){return 0===this.indexOf(a)},String.prototype.replaceAll=function(a,b){var c=new RegExp(a,"g");return this.replace(c,b)};var defaultDiacriticsRemovalMap=[{base:"A",letters:new RegExp("[AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ]","g")},{base:"AA",letters:new RegExp("[Ꜳ]","g")},{base:"AE",letters:new RegExp("[ÆǼǢ]","g")},{base:"AO",letters:new RegExp("[Ꜵ]","g")},{base:"AU",letters:new RegExp("[Ꜷ]","g")},{base:"AV",letters:new RegExp("[ꜸꜺ]","g")},{base:"AY",letters:new RegExp("[Ꜽ]","g")},{base:"B",letters:new RegExp("[BⒷＢḂḄḆɃƂƁ]","g")},{base:"C",letters:new RegExp("[CⒸＣĆĈĊČÇḈƇȻꜾ]","g")},{base:"D",letters:new RegExp("[DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ]","g")},{base:"DZ",letters:new RegExp("[ǱǄ]","g")},{base:"Dz",letters:new RegExp("[ǲǅ]","g")},{base:"E",letters:new RegExp("[EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ]","g")},{base:"F",letters:new RegExp("[FⒻＦḞƑꝻ]","g")},{base:"G",letters:new RegExp("[GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ]","g")},{base:"H",letters:new RegExp("[HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ]","g")},{base:"I",letters:new RegExp("[IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ]","g")},{base:"J",letters:new RegExp("[JⒿＪĴɈ]","g")},{base:"K",letters:new RegExp("[KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ]","g")},{base:"L",letters:new RegExp("[LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ]","g")},{base:"LJ",letters:new RegExp("[Ǉ]","g")},{base:"Lj",letters:new RegExp("[ǈ]","g")},{base:"M",letters:new RegExp("[MⓂＭḾṀṂⱮƜ]","g")},{base:"N",letters:new RegExp("[NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ]","g")},{base:"NJ",letters:new RegExp("[Ǌ]","g")},{base:"Nj",letters:new RegExp("[ǋ]","g")},{base:"O",letters:new RegExp("[OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ]","g")},{base:"OI",letters:new RegExp("[Ƣ]","g")},{base:"OO",letters:new RegExp("[Ꝏ]","g")},{base:"OU",letters:new RegExp("[Ȣ]","g")},{base:"P",letters:new RegExp("[PⓅＰṔṖƤⱣꝐꝒꝔ]","g")},{base:"Q",letters:new RegExp("[QⓆＱꝖꝘɊ]","g")},{base:"R",letters:new RegExp("[RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ]","g")},{base:"S",letters:new RegExp("[SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ]","g")},{base:"T",letters:new RegExp("[TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ]","g")},{base:"TZ",letters:new RegExp("[Ꜩ]","g")},{base:"U",letters:new RegExp("[UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ]","g")},{base:"V",letters:new RegExp("[VⓋＶṼṾƲꝞɅ]","g")},{base:"VY",letters:new RegExp("[Ꝡ]","g")},{base:"W",letters:new RegExp("[WⓌＷẀẂŴẆẄẈⱲ]","g")},{base:"X",letters:new RegExp("[XⓍＸẊẌ]","g")},{base:"Y",letters:new RegExp("[YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ]","g")},{base:"Z",letters:new RegExp("[ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ]","g")},{base:"a",letters:new RegExp("[aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ]","g")},{base:"aa",letters:new RegExp("[ꜳ]","g")},{base:"ae",letters:new RegExp("[æǽǣ]","g")},{base:"ao",letters:new RegExp("[ꜵ]","g")},{base:"au",letters:new RegExp("[ꜷ]","g")},{base:"av",letters:new RegExp("[ꜹꜻ]","g")},{base:"ay",letters:new RegExp("[ꜽ]","g")},{base:"b",letters:new RegExp("[bⓑｂḃḅḇƀƃɓ]","g")},{base:"c",letters:new RegExp("[cⓒｃćĉċčçḉƈȼꜿↄ]","g")},{base:"d",letters:new RegExp("[dⓓｄḋďḍḑḓḏđƌɖɗꝺ]","g")},{base:"dz",letters:new RegExp("[ǳǆ]","g")},{base:"e",letters:new RegExp("[eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ]","g")},{base:"f",letters:new RegExp("[fⓕｆḟƒꝼ]","g")},{base:"g",letters:new RegExp("[gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ]","g")},{base:"h",letters:new RegExp("[hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ]","g")},{base:"hv",letters:new RegExp("[ƕ]","g")},{base:"i",letters:new RegExp("[iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı]","g")},{base:"j",letters:new RegExp("[jⓙｊĵǰɉ]","g")},{base:"k",letters:new RegExp("[kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ]","g")},{base:"l",letters:new RegExp("[lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ]","g")},{base:"lj",letters:new RegExp("[ǉ]","g")},{base:"m",letters:new RegExp("[mⓜｍḿṁṃɱɯ]","g")},{base:"n",letters:new RegExp("[nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ]","g")},{base:"nj",letters:new RegExp("[ǌ]","g")},{base:"o",letters:new RegExp("[oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ]","g")},{base:"oi",letters:new RegExp("[ƣ]","g")},{base:"ou",letters:new RegExp("[ȣ]","g")},{base:"oo",letters:new RegExp("[ꝏ]","g")},{base:"p",letters:new RegExp("[pⓟｐṕṗƥᵽꝑꝓꝕ]","g")},{base:"q",letters:new RegExp("[qⓠｑɋꝗꝙ]","g")},{base:"r",letters:new RegExp("[rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ]","g")},{base:"s",letters:new RegExp("[sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ]","g")},{base:"t",letters:new RegExp("[tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ]","g")},{base:"tz",letters:new RegExp("[ꜩ]","g")},{base:"u",letters:new RegExp("[uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ]","g")},{base:"v",letters:new RegExp("[vⓥｖṽṿʋꝟʌ]","g")},{base:"vy",letters:new RegExp("[ꝡ]","g")},{base:"w",letters:new RegExp("[wⓦｗẁẃŵẇẅẘẉⱳ]","g")},{base:"x",letters:new RegExp("[xⓧｘẋẍ]","g")},{base:"y",letters:new RegExp("[yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ]","g")},{base:"z",letters:new RegExp("[zⓩｚźẑżžẓẕƶȥɀⱬꝣ]","g")}];String.prototype.removeDiacritics=function(){for(var a=this,b=0;b<defaultDiacriticsRemovalMap.length;b++)a=a.replace(defaultDiacriticsRemovalMap[b].letters,defaultDiacriticsRemovalMap[b].base);return a},Date.prototype.format=function(a){for(var b=function(a){var b=a.toString();return 1===b.length?"0"+b:b},c=[["yyyy",this.getYear()+1900],["yy",this.getYear()%100],["MM",this.getMonth()+1],["dd",this.getDate()],["HH",this.getHours()],["mm",b(this.getMinutes())],["ss",b(this.getSeconds())]],d=a,e=0;e<c.length;e++){var f=new RegExp(c[e][0],"g");d=d.replace(f,c[e][1])}return d};var Static;!function(a){var b=function(){function a(){}return a.Entity="Entity",a.Metadata="Metadata",a.Dashboard="Dashboard",a}();a.ControllerArea=b}(Static||(Static={}));var Static;!function(a){var b=function(){function a(){}return a.Entity="Entity",a.EntityData="EntityData",a.EntityList="EntityList",a.EntityListMetadata="EntityListMetadata",a.EntityListCache="EntityListCache",a.EntitySubmit="EntitySubmit",a.EntityDelete="EntityDelete",a.EntityMetadataListCache="EntityMetadataListCache",a.EntitySchemaData="EntitySchemaData",a.EntitySchemaSubmit="EntitySchemaSubmit",a.FilteredListMetadata="FilteredListMetadata",a.FieldListMetadata="FieldListMetadata",a.FieldSchemaData="FieldSchemaData",a.FieldSchemaSubmit="FieldSchemaSubmit",a.LoggingIn="LoggingIn",a.DashboardSummary="DashboardSummary",a.DashboardMyActivity="DashboardMyActivity",a.DashboardActivity="DashboardActivity",a}();a.LoadingType=b}(Static||(Static={}));var Static;!function(a){var b=function(){function a(){}return a.RouteParamSystemPrefix="_",a.EntityName=a.RouteParamSystemPrefix+"entityName",a.EntityId=a.RouteParamSystemPrefix+"entityId",a.PageNumber=a.RouteParamSystemPrefix+"pageNumber",a}();a.RouteParams=b}(Static||(Static={}));var Static;!function(a){var b=function(){function a(){}return a.Entity="Entity",a.Metadata="Metadata",a}();a.PluginDataType=b}(Static||(Static={}));var Static;!function(a){var b=function(){function a(){}return a.Create="Create",a.Update="Update",a.Delete="Delete",a}();a.PluginOperation=b}(Static||(Static={}));var Static;!function(a){var b=function(){function a(){}return a.Error="Error",a.Warning="Warning",a.Information="Information",a.Success="Success",a}();a.NotificationSeverity=b}(Static||(Static={}));var Config;!function(a){var b=function(){function a(){}return a.SystemPrefix="__",a.SystemEntityName=a.SystemPrefix+"BerryFormsSystem",a.SystemColorIdentifier=a.SystemPrefix+"color"+a.SystemPrefix,a.SystemIconIdentifier=a.SystemPrefix+"icon"+a.SystemPrefix,a.ApiBaseUrl="./api/",a.LoadResourcesAsynchronously=!0,a.LanguagesSupported=["en","sk","sr"],a.LanguageDefault="en",a.LocalizedResourcesBaseUrl="angular/localization/{0}/resources.js",a.DatepickerFormat="dd.MM.yyyy",a.DatepickerOptions={"year-format":"'yyyy'","starting-day":1},a.SearchTypingWaitTimeMs=500,a.SearchMinExpressionLength=3,a.SearchListSize=4,a.NotificationDisplayTimeMs=5e3,a.EntityListPageSize=10,a}();a.Client=b}(Config||(Config={}));var ConfigHelper;!function(a){var b=function(){function a(){}return a.GetFieldsConfigurationFor=function(a){switch(a){case"Date":return{DatepickerFormat:Config.Client.DatepickerFormat,DatepickerOptions:Config.Client.DatepickerOptions};default:return null}},a}();a.Client=b}(ConfigHelper||(ConfigHelper={}));var _global=this;_global.ServerObjects=_global.ServerObjects||{};var Config;!function(a){var b=function(){function b(){}return b.ApplyConfigurationOverrides=function(){var b=_global.ServerObjects.ConfigurationOverrides||{};for(var c in b)b.hasOwnProperty(c)&&(a.Client[c]=b[c])},b}();!function(){b.ApplyConfigurationOverrides()}()}(Config||(Config={}));var _global=this;_global.ResourcesToLoad=_global.ResourcesToLoad||[];var Localization;!function(Localization){var LocalizationLoader=function(){function LocalizationLoader(){}return LocalizationLoader.LoadLocalizationFile=function(){var a=this.DetermineUserLanguage(),b=Config.Client.LocalizedResourcesBaseUrl.format([a]);_global.ResourcesToLoad.push({Url:b,Callback:LocalizationLoader.ResourceLoaded}),document.body.className=a},LocalizationLoader.DetermineUserLanguage=function(){var a=navigator.language||navigator.userLanguage||Config.Client.LanguageDefault;return Config.Client.LanguagesSupported.contains(a)?a:Config.Client.LanguageDefault},LocalizationLoader.ResourceLoaded=function(data){eval(data)},LocalizationLoader}();!function(){LocalizationLoader.LoadLocalizationFile()}()}(Localization||(Localization={}));var _global=this,Helpers;!function(a){var b=function(){function a(){}return a.LoadRemainingResources=function(b){for(var c=a.ResourcesToLoad.createCopy(),d=0;d<c.length;d++){var e=c[d],f=function(c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.Callback&&c.Callback(d.responseText):console.error("Could not load resource '{0}'".format([c.Url])),a.ResourcesToLoad.remove(c),a.CheckRemainingResources(b))},d.open("GET",c.Url,Config.Client.LoadResourcesAsynchronously),d.send(null)};f(e)}a.CheckRemainingResources(b)},a.CheckRemainingResources=function(b){0!==a.ResourcesToLoad.length||a.SetupDone||(a.SetupDone=!0,b&&b())},a.ResourcesToLoad=_global.ResourcesToLoad||[],a.SetupDone=!1,a}();a.ResourceLoader=b}(Helpers||(Helpers={}));var Models;!function(a){var b=function(){function a(){}return a}();a.PersistentObject=b}(Models||(Models={}));var Models;!function(a){var b=function(){function a(a){this.FieldSpecialProperties=[],this.FieldTypeName=a,this.Configuration=ConfigHelper.Client.GetFieldsConfigurationFor(a)}return a.prototype.MapAdditionalProperties=function(a,b){throw new Error},a.prototype.ValidateValue=function(a){var b=null!=a&&0!==a.length&&""!==a.Value;return!this.Required||b},a}();a.FieldMetadata=b}(Models||(Models={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this),this.Fields=[],this.Permissions=[]}return __extends(b,a),b}(a.PersistentObject);a.EntityMetadata=b}(Models||(Models={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},_global=this,Models;!function(a){var b=function(a){function b(b){a.call(this),this.EntitySystemName=b,this.Data={},this.ErrorFields=[]}return __extends(b,a),b.prototype.ValidateAllFields=function(a){this.ErrorFields=[];for(var b=a.Fields&&a.Fields.length||0,c=0;b>c;c++){var d=a.Fields[c],e=this.Data[d.FieldSystemName],f=d.ValidateValue(e);f||this.ErrorFields.add(d.FieldSystemName)}},b.prototype.GetDisplayName=function(a){for(var b=[],c=0;c<a.Fields.length;c++){var d=a.Fields[c];if(d.DisplayInListName){var e=_global.Instances.FieldTypesRegistry.GetFieldType(d.FieldTypeName,!0),f=this.Data[d.FieldSystemName],g=e.FormatValue(f);g&&b.push(g)}}return b.join(" - ")},b}(a.PersistentObject);a.Entity=b}(Models||(Models={}));var Models;!function(a){var b=function(){function a(){this.Roles=[],this.ApplicationPermissions=[]}return a}();a.User=b}(Models||(Models={}));var Models;!function(a){var b=function(){function a(){}return a}();a.SecurityRole=b}(Models||(Models={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(){function a(){}return a}();a.Permission=b;var c=function(a){function b(){a.call(this),this.AllowRoles=[],this.DenyRoles=[],this.AllowUsers=[],this.DenyUsers=[]}return __extends(b,a),b}(b);a.CascadingPermission=c}(Models||(Models={}));var Models;!function(a){var b=function(){function a(){}return a}();a.UserSession=b}(Models||(Models={}));var Models;!function(a){var b=function(){function a(a,b,c){this.Data=a,this.DataType=b,this.OperationType=c,this.CancelPluginOperation=!1,this.PluginsExecutedCount=0}return a.CreateForEntity=function(b,c){return new a(b,Static.PluginDataType.Entity,c)},a.CreateForMetadata=function(b,c){return new a(b,Static.PluginDataType.Metadata,c)},a.prototype.SetCancellation=function(a,b){if(this.CancelPluginOperation)throw new Error;this.CancelPluginOperation=!0,this.CancellationPlugin=a,this.CancellationMessage=b},a}();a.PluginContext=b}(Models||(Models={}));var _global=this,Interceptors;!function(a){var b=function(){function a(){}return a.injection=function(){return["$log",a.FactoryRegistration]},a.FactoryRegistration=function(b){return a.Log=b,a.HandleUncaughtError},a.HandleUncaughtError=function(b){a.Log.error(b);var c=_global.Instances&&_global.Instances.MessagingService&&_global.Instances.MessagingService.Messages,d=_global.Localization.Resources;c&&d&&c.Notification.Message.publish(d.UnknownError,Static.NotificationSeverity.Error)},a}();a.ExceptionHandler=b}(Interceptors||(Interceptors={}));var Data;!function(a){var b=function(){function a(){}return a.GetData=function(){var a=new Models.EntityMetadata;return a.EntityName=Config.Client.SystemEntityName,a.Fields=[this.EntityNameField(),this.EntityDescriptionField(),this.EntityColorField(),this.EntityIconField()],a},a.EntityNameField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="EntityName",a.FieldName=Services.LocalizationService.Resources.EntityName,a.FieldDescription=a.FieldName,a.Required=!0,a.RegularExpression="^[a-zA-Z\\u00C0-\\u017F0-9 ]*$",a},a.EntityDescriptionField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="EntityDescription",a.FieldName=Services.LocalizationService.Resources.EntityDescription,a.FieldDescription=a.FieldName,a.MaxLength=100,a},a.EntityColorField=function(){var a=new Models.SelectFieldMetadata;return a.FieldSystemName="IconColorHex",a.FieldName=Services.LocalizationService.Resources.EntityColor,a.FieldDescription=a.FieldName,a.Values=[new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorDefault,Config.Client.SystemColorIdentifier),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorKhaki,Config.Client.SystemColorIdentifier+"#DAD4BE"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorGray,Config.Client.SystemColorIdentifier+"#D3D2D5"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorLightPurple,Config.Client.SystemColorIdentifier+"#F5F1F2"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorPurple,Config.Client.SystemColorIdentifier+"#EADCE0"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorDarkPurple,Config.Client.SystemColorIdentifier+"#C8AEB4"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorOrange,Config.Client.SystemColorIdentifier+"#FFECC5"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorViolet,Config.Client.SystemColorIdentifier+"#D6C8FA"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorBlue,Config.Client.SystemColorIdentifier+"#C8D3FA"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.ColorBrown,Config.Client.SystemColorIdentifier+"#DEC0BA")],a.Required=!0,a},a.EntityIconField=function(){var a=new Models.SelectFieldMetadata;return a.FieldSystemName="IconClassName",a.FieldName=Services.LocalizationService.Resources.EntityIcon,a.FieldDescription=a.FieldName,a.Values=[new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconEuro,Config.Client.SystemIconIdentifier+"euro"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconCloud,Config.Client.SystemIconIdentifier+"cloud"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconEnvelope,Config.Client.SystemIconIdentifier+"envelope"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconPencil,Config.Client.SystemIconIdentifier+"pencil"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconMusic,Config.Client.SystemIconIdentifier+"music"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconHeart,Config.Client.SystemIconIdentifier+"heart"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconStar,Config.Client.SystemIconIdentifier+"star"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconUser,Config.Client.SystemIconIdentifier+"user"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconOk,Config.Client.SystemIconIdentifier+"ok"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconRemove,Config.Client.SystemIconIdentifier+"remove"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconSearch,Config.Client.SystemIconIdentifier+"search"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconSignal,Config.Client.SystemIconIdentifier+"signal"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconCog,Config.Client.SystemIconIdentifier+"cog"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconHome,Config.Client.SystemIconIdentifier+"home"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconTime,Config.Client.SystemIconIdentifier+"time"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconRoad,Config.Client.SystemIconIdentifier+"road"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconEuro,Config.Client.SystemIconIdentifier+"euro"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconBarcode,Config.Client.SystemIconIdentifier+"barcode"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconPrint,Config.Client.SystemIconIdentifier+"print"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconLeaf,Config.Client.SystemIconIdentifier+"leaf"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconFire,Config.Client.SystemIconIdentifier+"fire"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconPlane,Config.Client.SystemIconIdentifier+"plane"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconGlobe,Config.Client.SystemIconIdentifier+"globe"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconPaperclip,Config.Client.SystemIconIdentifier+"paperclip"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconCutlery,Config.Client.SystemIconIdentifier+"cutlery"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconBriefcase,Config.Client.SystemIconIdentifier+"briefcase"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconCalendar,Config.Client.SystemIconIdentifier+"calendar"),new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources.IconFilm,Config.Client.SystemIconIdentifier+"film")],a.Required=!0,a},a}();a.CreateEntityFormFields=b}(Data||(Data={}));var _global=this,Data;!function(a){var b=function(){function a(){}return a.GetData=function(a,b){void 0===b&&(b=!1);var c;if(c=a?this.GetFieldData(a):this.GetInitialData(),b){var d=function(a){return"FieldName"===a.FieldSystemName},e=c.Fields.single(d);e.ReadOnly=!0}return c},a.GetInitialData=function(){var a=new Models.EntityMetadata;return a.EntityName=Config.Client.SystemEntityName,a.Fields=[this.FieldNameField(),this.FieldDescriptionField(),this.FieldTypeNameField(),this.FieldRequiredField(),this.FieldDisplayInListNameField()],a},a.GetFieldData=function(a){var b=_global.Components.FieldTypes,c=function(b){return b.FieldName===a},d=b.single(c);if(d)return d.CreateFieldForm();throw new Error},a.FieldTypeNameField=function(){var a=new Models.SelectFieldMetadata;return a.FieldSystemName="FieldTypeName",a.FieldName=Services.LocalizationService.Resources.FieldTypeName,a.FieldDescription=a.FieldName,a.Required=!0,a.Values=[],angular.forEach(_global.Components.FieldTypes,function(b){var c=new Models.SelectFieldOptionMetadata(Services.LocalizationService.Resources[b.FieldName+"Field"],b.FieldName);a.Values.push(c)}),a},a.FieldNameField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="FieldName",a.FieldName=Services.LocalizationService.Resources.FieldName,a.DisplayInListName=!0,a.FieldDescription=a.FieldName,a.Required=!0,a.RegularExpression="^[a-zA-Z\\u00C0-\\u017F0-9 ]*$",a},a.FieldDescriptionField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="FieldDescription",a.FieldName=Services.LocalizationService.Resources.FieldDescription,a.DisplayInListName=!0,a.FieldDescription=a.FieldName,a.MaxLength=100,a},a.FieldRequiredField=function(){var a=new Models.BooleanFieldMetadata;return a.FieldSystemName="Required",a.FieldName=Services.LocalizationService.Resources.Required,a.FieldDescription=a.FieldName,a.ThreeState=!1,a.Required=!0,a},a.FieldDisplayInListNameField=function(){var a=new Models.BooleanFieldMetadata;return a.FieldSystemName="DisplayInListName",a.FieldName=Services.LocalizationService.Resources.DisplayInList,a.FieldDescription=a.FieldName,a.ThreeState=!1,a.Required=!0,a},a}();a.CreateFieldFormFields=b}(Data||(Data={}));var Data;!function(a){var b=function(){function a(){}return a.GetData=function(){var a=new Models.EntityMetadata;return a.EntityName=Config.Client.SystemEntityName,a.Fields=[this.UserNameField(),this.PasswordField(),this.StayLoggedInField()],a},a.UserNameField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="UserName",a.FieldName=Services.LocalizationService.Resources.UserName,a.FieldDescription=a.FieldName,a.Required=!0,a.RegularExpression="^[a-zA-Z0-9]{4,12}$",a},a.PasswordField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="Password",a.FieldName=Services.LocalizationService.Resources.Password,a.FieldDescription=a.FieldName,a.Required=!0,a.MaskCharacters=!0,a.RegularExpression="^[a-zA-Z]\\w{4,12}$",a},a.StayLoggedInField=function(){var a=new Models.BooleanFieldMetadata;return a.FieldSystemName="StayLoggedIn",a.FieldName=Services.LocalizationService.Resources.StayLoggedIn,a.FieldDescription=a.FieldName,a.Required=!0,a},a}();a.CreateLoginFormFields=b}(Data||(Data={}));var Directives;!function(a){var b=function(){function a(){}return a.injection=function(){return["$timeout","$window",a.DirectiveOptions]},a.DirectiveOptions=function(b,c){return a.Timeout=b,a.Window=c,{restrict:"A",scope:{expandIconSize:"=",iconSize:"=",iconCount:"="},replace:!1,link:function(b,c,d){var e=new a;e.Link(b,c,d)}}},a.prototype.Link=function(b,c,d){this.Scope=b,this.Element=c,this.SizeChanged(),b.$watch("iconCount",this.SizeChanged.bind(this)),angular.element(a.Window).on("resize",this.SizeChanged.bind(this)),this.BindExpandButton()},a.prototype.SizeChanged=function(){a.Timeout.cancel(this.Promise),this.Promise=a.Timeout(this.SetIconsVisibility.bind(this),0,!1)},a.prototype.MeasureDimensions=function(){this.WindowDimensions={width:a.Window.innerWidth,height:a.Window.innerHeight},this.MenuDimensions={width:this.Element[0].offsetWidth,height:this.Element[0].offsetHeight},this.MenuDimensions.primaryDimensionSize=Math.max(this.MenuDimensions.width,this.MenuDimensions.height),this.MenuDimensions.primaryDimension=this.MenuDimensions.height>this.MenuDimensions.width?"height":"width",this.MenuDimensions.secondaryDimension="height"===this.MenuDimensions.primaryDimension?"width":"height"},a.prototype.SetIconsVisibility=function(){this.Element.hasClass("expanded")&&this.ExpandCollapseMenu(null,!0),this.Element.removeClass("collapsed");var a=this.Element.children();angular.forEach(a,function(a,b){angular.element(a).removeClass("collapsed")}),this.MeasureDimensions();var b=this.MenuDimensions.primaryDimensionSize,c=(this.Scope.iconCount||0)*this.Scope.iconSize<=b;if(!c){this.Element.addClass("collapsed");var d=Math.floor((b-this.Scope.expandIconSize)/this.Scope.iconSize);angular.forEach(a,function(a,b){"menuEntityExpand"!==a.className&&b>=d&&angular.element(a).addClass("collapsed")})}},a.prototype.BindExpandButton=function(){var a=this.Element[0].querySelector(".menuEntityExpand");a.onclick=this.ExpandCollapseMenu.bind(this),a.onblur=this.ExpandCollapseMenu.bind(this)},a.prototype.ExpandCollapseMenu=function(a,b){var c=this,d=this.Element.hasClass("expanded"),e=null!==b?b:d;if("blur"===a.type&&(e=!0),e)setTimeout(function(){c.Element.addClass("collapsed"),c.Element.removeClass("expanded"),c.Element.css(c.MenuDimensions.primaryDimension,""),c.Element.css(c.MenuDimensions.secondaryDimension,""),c.Element.css("max-"+c.MenuDimensions.secondaryDimension,"")},200);else{var f=this.Scope.iconCount+1,g=Math.floor((this.MenuDimensions.primaryDimensionSize-this.Scope.expandIconSize)/this.Scope.iconSize),h=Math.ceil(f/g),i=Math.min(h*this.Scope.iconSize,this.WindowDimensions[this.MenuDimensions.secondaryDimension]-this.Scope.iconSize),j=Math.floor(i/this.Scope.iconSize),k=Math.ceil(f/j),l=Math.min(k*this.Scope.iconSize,this.WindowDimensions[this.MenuDimensions.primaryDimension]-this.Scope.iconSize);this.Element.removeClass("collapsed"),this.Element.addClass("expanded"),this.Element.css(this.MenuDimensions.primaryDimension,l+"px"),this.Element.css(this.MenuDimensions.secondaryDimension,i+"px"),this.Element.css("max-"+this.MenuDimensions.secondaryDimension,i+"px")}},a}();a.LeftMenuAutosize=b}(Directives||(Directives={}));var Directives;!function(a){var b=function(){function a(){this.Types=[{Name:"Icon",SystemName:Config.Client.SystemIconIdentifier},{Name:"Color",SystemName:Config.Client.SystemColorIdentifier}]}return a.injection=function(){return[a.DirectiveOptions]},a.DirectiveOptions=function(){return{restrict:"A",scope:"=",replace:!0,templateUrl:"angular/views/systemSymbol.html",link:function(b,c,d){var e=new a;e.Link(b,c,d)}}},a.prototype.Link=function(a,b,c){var d=c.systemSymbol;this.Scope=a,this.Scope.SymbolModel=this.CreateSymbolModel(d);var e=this;c.$observe("systemSymbol",function(a){a&&(e.Scope.SymbolModel=e.CreateSymbolModel(a))})},a.prototype.CreateSymbolModel=function(a){var b=null,c=null,d=!1;return angular.forEach(this.Types,function(e){!d&&a&&a.startsWith(e.SystemName)&&(b=e.Name,c=a.substr(e.SystemName.length),d=!0)}),{Type:b,Name:c}},a}();a.SystemSymbol=b}(Directives||(Directives={}));var Directives;!function(a){var b=function(){function a(){}return a.injection=function(){return["$compile","FieldTypesRegistry",a.DirectiveOptions]},a.DirectiveOptions=function(b,c){return a.Compile=b,a.FieldTypesRegistry=c,{restrict:"A",scope:"=",replace:!1,link:function(b,c,d){var e=new a;e.Link(b,c,d)}}},a.prototype.Link=function(b,c,d){this.Scope=b,this.Element=c;var e=a.FieldTypesRegistry.GetFieldType(this.Scope.field.FieldTypeName,!0);if(d.readonly){var f=this.Scope.listItem.Data[this.Scope.field.FieldSystemName],g=e.FormatValue(f);this.Element.html(g)}else{var h="<span class='fieldComponent {0}' data-id='{1}'></span>",i=e.DirectiveName,j=this.Scope.field.FieldSystemName,k=h.format([i,j]);this.Element.html(k),a.Compile(this.Element.contents())(this.Scope)}},a}();a.FieldComponentCreator=b}(Directives||(Directives={}));var Directives;!function(a){var b=function(){function a(){}return a.injection=function(){return["LocalizationService","EntityMetadataListCacheService",a.DirectiveOptions]},a.DirectiveOptions=function(b,c){return a.EntityMetadataListCacheService=c,a.LocalizationService=b,{restrict:"A",scope:"=",replace:!0,templateUrl:"angular/views/dashboardActivityItemChart.html",link:function(b,c,d){var e=new a;e.Link(b,c,d)}}},a.prototype.Link=function(a,b,c){this.Scope=a,this.Element=b,this.ChartElement=this.Element[0].querySelector(".chartContainer"),this.CreateSummaryItemModel(a.activity)},a.prototype.CreateSummaryItemModel=function(b){this.Scope.SummaryItem={LegendTitle:a.LocalizationService.Resources.TotalCount.format([b.TotalOperationsCount]),TotalCount:b.TotalOperationsCount,Legend:[{title:a.LocalizationService.Resources.Created,count:b.CreatedCount||0,className:"created"},{title:a.LocalizationService.Resources.Updated,count:b.UpdatedCount||0,className:"updated"},{title:a.LocalizationService.Resources.Deleted,count:b.DeletedCount||0,className:"deleted"}],ChartData:{series:[]},ChartOptions:{showLabel:!1,labelDirection:"neutral"}},b.CreatedCount&&this.Scope.SummaryItem.ChartData.series.push({data:b.CreatedCount,className:"ct-series-a createdSeries"}),b.UpdatedCount&&this.Scope.SummaryItem.ChartData.series.push({data:b.UpdatedCount,className:"ct-series-b updatedSeries"}),b.DeletedCount&&this.Scope.SummaryItem.ChartData.series.push({data:b.DeletedCount,className:"ct-series-c deletedSeries"});var c=b.Collection;a.EntityMetadataListCacheService.LoadEntityMetadataFromCache(c,this.LoadEntityMetadataCompleted.bind(this))},a.prototype.LoadEntityMetadataCompleted=function(a,b){null===b&&(this.Scope.SummaryItem.EntitySystemName=a.EntitySystemName,this.Scope.SummaryItem.EntityName=a.EntityName),Chartist.Pie(this.ChartElement,this.Scope.SummaryItem.ChartData,this.Scope.SummaryItem.ChartOptions)},a}();a.DashboardActivityItemChart=b}(Directives||(Directives={}));var Services;!function(a){var b=function(){function a(){this.Form={DisplayItem:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a,b){throw new Error}}},this.EntityList={},this.Metadata={Created:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Modified:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Deleted:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}}},this.Entity={Created:{subscribe:function(a){throw new Error;
},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Modify:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Modified:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Delete:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Deleted:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}}},this.Notification={Message:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a,b){throw new Error}}},this.Loading={Started:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Finished:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Reset:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(){throw new Error}}},this.Cache={MetadataList:{Loaded:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Invalidated:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(){throw new Error}}},EntityList:{DataLoaded:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Changed:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Invalidated:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}}}},this.Dialog={Create:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},Remove:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(){throw new Error}}},this.User={LoggedOut:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}},LoggedIn:{subscribe:function(a){throw new Error},unsubscribe:function(a){throw new Error},publish:function(a){throw new Error}}}}return a}();a.IMessagingServiceType=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){this.NextPage={Notifications:{add:function(a,b){throw new Error},retrieveFirst:function(){throw new Error},retrieveLast:function(){throw new Error},retrieveAll:function(){throw new Error}}}}return a}();a.IQueueServiceType=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a){this.RootScope=a,this.SubscriberList=[]}return a.prototype.GetSubscribers=function(a){var b=this.SubscriberList[a];return"undefined"==typeof b&&(b=[],this.SubscriberList[a]=b),b},a.prototype.AddSubscriber=function(a,b){var c=this.GetSubscribers(a),d=c.indexOf(b);-1===d&&c.push(b);var e=this;return function(){e.RemoveSubscriber(a,b)}},a.prototype.AddOneTimeSubscriber=function(a,b){var c=this,d=function(e){b(e),c.RemoveSubscriber(a,d)};return this.AddSubscriber(a,d),function(){c.RemoveSubscriber(a,d)}},a.prototype.RemoveSubscriber=function(a,b){var c=this.GetSubscribers(a);"undefined"==typeof b&&c.splice(0);var d=c.indexOf(b);d>-1&&c.splice(d,1)},a.prototype.NotifySubscribers=function(a,b,c){void 0===c&&(c=!1);for(var d=this.GetSubscribers(a).createCopy(),e=0;e<d.length;e++){var f=d[e];this.InvokeSubscriberCallback(f,b,c)}},a.prototype.InvokeSubscriberCallback=function(a,b,c){c?this.RootScope.$apply(function(){a(b)}):a(b)},a}();a.MessagingBaseService=b}(Services||(Services={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},_global=this,Services;!function(a){var b=function(b){function c(a){b.call(this,a),this.CreateMessageDefinitions(),this.Setup()}return __extends(c,b),c.injection=function(){return["$rootScope",c]},c.prototype.Setup=function(){this.ImplementAllMessageDefinitions(),_global.Instances=_global.Instances||{},_global.Instances.MessagingService=this},c.prototype.CreateMessageDefinitions=function(){this.Messages=new a.IMessagingServiceType,this.MessageDefinitions=[["formDisplayItem",this.Messages.Form.DisplayItem,!1,function(a,b){return{Data:a,Metadata:b}}],["notificationMessage",this.Messages.Notification.Message,!1,function(a,b){return{Message:a,Severity:b}}],["metadataCreated",this.Messages.Metadata.Created,!1,null],["metadataModified",this.Messages.Metadata.Modified,!1,null],["metadataDeleted",this.Messages.Metadata.Deleted,!1,null],["entityCreated",this.Messages.Entity.Created,!1,null],["entityModify",this.Messages.Entity.Modify,!1,null],["entityModified",this.Messages.Entity.Modified,!1,null],["entityDelete",this.Messages.Entity.Delete,!1,null],["entityDeleted",this.Messages.Entity.Deleted,!1,null],["loadingStarted",this.Messages.Loading.Started,!1,null],["loadingFinished",this.Messages.Loading.Finished,!1,null],["loadingReset",this.Messages.Loading.Reset,!1,null],["cacheMetadataListLoaded",this.Messages.Cache.MetadataList.Loaded,!1,null],["cacheMetadataListInvalidated",this.Messages.Cache.MetadataList.Invalidated,!1,null],["cacheEntityListDataLoaded",this.Messages.Cache.EntityList.DataLoaded,!1,null],["cacheEntityListDataChanged",this.Messages.Cache.EntityList.Changed,!1,null],["cacheEntityListDataInvalidated",this.Messages.Cache.EntityList.Invalidated,!1,null],["dialogCreate",this.Messages.Dialog.Create,!1,null],["dialogRemove",this.Messages.Dialog.Remove,!1,null],["userLoggedIn",this.Messages.User.LoggedIn,!1,null],["userLoggedOut",this.Messages.User.LoggedOut,!1,null]]},c.prototype.ImplementAllMessageDefinitions=function(){for(var a=0;a<this.MessageDefinitions.length;a++){var b=this.MessageDefinitions[a];this.ImplementMessage(b)}},c.prototype.ImplementMessage=function(a){var b=this,c=a[0],d=a[1],e=a[2],f=a[3];d.subscribe=function(a){return b.AddSubscriber(c,a)},d.unsubscribe=function(a){b.RemoveSubscriber(c,a)},d.publish=function(a,d,g,h,i){var j=f?f(a,d,g,h,i):a||null;b.NotifySubscribers(c,j,e)}},c}(a.MessagingBaseService);a.MessagingService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){this._queues=[]}return a.prototype.addToQueue=function(a,b){var c=this._queues[a];"undefined"==typeof c&&(c=[],this._queues[a]=c),c.push(b)},a.prototype.retrieveMessageFromQueue=function(a,b){var c=this._queues[a];return"undefined"==typeof c?null:0===c.length?null:b?c.shift():c.pop()},a.prototype.retrieveAllMessagesFromQueue=function(a){var b=this._queues[a];if("undefined"==typeof b)return null;if(0===b.length)return[];var c=b.createCopy();return this._queues[a]=[],c},a}();a.QueueBaseService=b}(Services||(Services={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Services;!function(a){var b=function(b){function c(){b.call(this),this.Setup()}return __extends(c,b),c.injection=function(){return[c]},c.prototype.Setup=function(){this.Queues=new a.IQueueServiceType,this.SetupNextPageNotifications()},c.prototype.SetupNextPageNotifications=function(){var a=this,b="nextPageNotifications";this.Queues.NextPage.Notifications.add=function(c,d){a.addToQueue(b,{Message:c,Severity:d})},this.Queues.NextPage.Notifications.retrieveFirst=function(){return a.retrieveMessageFromQueue(b,!0)},this.Queues.NextPage.Notifications.retrieveLast=function(){return a.retrieveMessageFromQueue(b,!1)},this.Queues.NextPage.Notifications.retrieveAll=function(){return a.retrieveAllMessagesFromQueue(b)}},c}(a.QueueBaseService);a.QueueService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){}return a.injection=function(){return[a]},a.prototype.GetSystemEntityName=function(a){return a.toLowerCase().removeDiacritics().replaceAll(" ","_")},a.prototype.GetSystemFieldName=function(a){return a.toLowerCase().removeDiacritics().replaceAll(" ","")},a}();a.NamingConventionsService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){}return a.prototype.AutomapProperties=function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&(null==a[d]||null!=c&&!c.contains(d)||(b[d]=a[d]))},a.prototype.GetSelectFieldOptionFromStringProperty=function(a,b){var c=a[b];return new Models.SelectFieldOptionMetadata(c,c)},a.prototype.GetSelectFieldOptionsFromArrayProperty=function(a,b){var c=a[b],d=[];if(!c.length)return d;for(var e=0;e<c.length;e++){var f=c[e],g=new Models.SelectFieldOptionMetadata(f,f);d.push(g)}return d},a}();a.ObjectMapperBaseService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b){this.LocationService=a,this.MessagingService=b}return a.injection=function(){return["$location","MessagingService",a]},a.prototype.RedirectToHomeScreen=function(){var a=this.GetHomeScreenUrl();this.ResetLoadingsBeforeRedirect(),this.LocationService.path(a)},a.prototype.RedirectToCreateEntitySchema=function(){var a=this.GetCreateEntitySchemaUrl();this.ResetLoadingsBeforeRedirect(),this.LocationService.path(a)},a.prototype.RedirectToEditEntitySchema=function(a){var b=this.GetEditEntitySchemaUrl(a);this.ResetLoadingsBeforeRedirect(),this.LocationService.path(b)},a.prototype.RedirectToCreateEntity=function(a){var b=this.GetCreateEntityUrl(a);this.ResetLoadingsBeforeRedirect(),this.LocationService.path(b)},a.prototype.RedirectToEditEntity=function(a,b){var c=this.GetEditEntityUrl(a,b);this.ResetLoadingsBeforeRedirect(),this.LocationService.path(c)},a.prototype.RedirectToEntityPage=function(a,b,c){var d=this.GetEntityPageUrl(a,b,c);this.ResetLoadingsBeforeRedirect(),this.LocationService.path(d)},a.prototype.RedirectToFilteredList=function(a,b,c){var d=this.GetFilteredListPageUrl(a,c);this.ResetLoadingsBeforeRedirect(),this.LocationService.path(d).search(b||"")},a.prototype.GetEditEntityUrl=function(a,b){var c="/entity/{0}/id/{1}";return c.format([a,b.toString()])},a.prototype.GetCreateEntityUrl=function(a){var b="/entity/{0}";return b.format([a])},a.prototype.GetHomeScreenUrl=function(){return"/"},a.prototype.GetCreateEntitySchemaUrl=function(){return"/schema/entity"},a.prototype.GetEditEntitySchemaUrl=function(a){var b="/schema/entity/{0}";return b.format([a])},a.prototype.GetEntityPageUrl=function(a,b,c){var d="/entity/{0}",e=b?b.toString():null;c>1||(c=null);var f=c?c.toString():null;return b&&c?d="/entity/{0}/page/{2}/id/{1}":b?d="/entity/{0}/id/{1}":c&&(d="/entity/{0}/page/{2}"),d.format([a,e,f])},a.prototype.GetFilteredListPageUrl=function(a,b){var c="/entity/{0}/filteredlist",d=b?b.toString():null;return d&&(c="/entity/{0}/filteredlist/page/{1}"),c.format([a,d])},a.prototype.ResetLoadingsBeforeRedirect=function(){this.MessagingService.Messages.Loading.Reset.publish()},a}();a.RedirectService=b}(Services||(Services={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Services;!function(a){var b=function(b){function c(a,c,d,e){b.call(this),this.NamingConventionsService=a,this.FieldTypesRegistry=c,this.NotificationService=d,this.LocalizationService=e,this.EntityToMetadataAutoProperties=["EntityName","EntityDescription"],this.FieldMetadataToEntityAutoProperties=["FieldName","FieldDescription","Required","DisplayInListName"],this.EntityToFieldMetadataAutoProperties=["FieldName","FieldDescription","Required","DisplayInListName"]}return __extends(c,b),c.injection=function(){return["NamingConventionsService","FieldTypesRegistry","NotificationService","LocalizationService",c]},c.prototype.MapEntityToEntityMetadataModel=function(a){var b=new Models.EntityMetadata;return this.AutomapProperties(a.Data,b,this.EntityToMetadataAutoProperties),b.Fields=[],b.EntitySystemName=this.NamingConventionsService.GetSystemEntityName(b.EntityName),b.IconClassName=a.Data.IconClassName.Value.substr(Config.Client.SystemIconIdentifier.length),b.IconColorHex=a.Data.IconColorHex.Value.substr(Config.Client.SystemColorIdentifier.length),b},c.prototype.MapFieldsMetadataToEntityModels=function(a){var b=this,c=[];return angular.forEach(a,function(a,d){var e=b.MapFieldMetadataToEntityModel(a);e.Id=d,c.push(e)}),c},c.prototype.MapEntityModelToFieldMetadata=function(a){var b=a.Data.FieldTypeName.Value,c=this.FieldTypesRegistry.GetFieldType(b,!1);if(!c){var d=this.LocalizationService.Resources.NonExistingFieldType.format([b]);return this.NotificationService.NotifyMessage(d,Static.NotificationSeverity.Error),null}var e=c.CreateMetadata();return this.AutomapProperties(a.Data,e,this.EntityToFieldMetadataAutoProperties.concat(e.FieldSpecialProperties)),e.MapAdditionalProperties(a,this),e.FieldSystemName=this.NamingConventionsService.GetSystemFieldName(e.FieldName),e.FieldTypeName=b,e},c.prototype.DeserializeEntityMetadataModel=function(a){var b=new Models.EntityMetadata;return this.AutomapProperties(a,b,null),b.Fields=this.DeserializeEntityMetadataModelFields(a),b},c.prototype.CloneEntityModel=function(a){var b=Object.clone(a);return this.DeserializeEntityModel(b)},c.prototype.DeserializeEntityModel=function(a){var b=new Models.Entity(a.EntitySystemName);return b.Id=a.Id,b.CreatedDate=a.CreatedDate,b.CreatedBy=a.CreatedBy,b.ModifiedDate=a.ModifiedDate,b.ModifiedBy=a.ModifiedBy,b.Data=a.Data,b},c.prototype.GetSelectFieldOptionFromEntityJson=function(a,b){var c=this.DeserializeEntityModel(a),d=c.GetDisplayName(b);return new Models.SelectFieldOptionMetadata(d,c.Id.toString())},c.prototype.DeserializeEntityMetadataModelFields=function(a){var b=this,c=[];if(null!=a.Fields)for(var d=0;d<a.Fields.length;d++){var e=a.Fields[d],f=b.DeserializeEntityMetadataModelField(e);c.add(f)}return c},c.prototype.DeserializeEntityMetadataModelField=function(a){var b=a.FieldTypeName,c=this.FieldTypesRegistry.GetFieldType(b,!1);if(!c){var d=this.LocalizationService.Resources.NonExistingFieldType.format([b]);return this.NotificationService.NotifyMessage(d,Static.NotificationSeverity.Error),null}var e=c.CreateMetadata();return this.AutomapProperties(a,e,null),e},c.prototype.MapFieldMetadataToEntityModel=function(b){var c=this.FieldTypesRegistry.GetFieldType(b.FieldTypeName,!1);if(!c){var d=this.LocalizationService.Resources.NonExistingFieldType.format([b.FieldTypeName]);return this.NotificationService.NotifyMessage(d,Static.NotificationSeverity.Error),null}var e=new Models.Entity(null);return e.EntitySystemName=b.FieldSystemName,e.Data.FieldTypeName=new Models.SelectFieldOptionMetadata(a.LocalizationService.Resources[c.FieldName+"Field"],c.FieldName),this.AutomapProperties(b,e.Data,this.FieldMetadataToEntityAutoProperties.concat(b.FieldSpecialProperties)),b.MapAdditionalProperties(e,this),e},c}(a.ObjectMapperBaseService);a.EntityModelMapperService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a){this.FieldTypesRegistry=a}return a.injection=function(){return["FieldTypesRegistry",a]},a.prototype.CreateDatabaseQueryFromFilter=function(a,b){var c={};if(!a||!a.Fields)return c;for(var d=0;d<a.Fields.length;d++){for(var e=a.Fields[d],f=this.FieldTypesRegistry.GetFieldType(e.FieldTypeName,!0),g=f.CreateFilterFields(e),h=[],i=0;i<g.length;i++){var j=g[i],k=b.Data[j.FieldSystemName];h.push(k)}var l=f.CreateFilterQuery(e,h);Object.copyKeys(l,c)}return c},a.prototype.CreateFilterFormMetadataFromEntityMetadata=function(a){var b=new Models.EntityMetadata;if(b.Fields=[],!a||!a.Fields)return null;for(var c=0;c<a.Fields.length;c++){var d=a.Fields[c],e=this.FieldTypesRegistry.GetFieldType(d.FieldTypeName,!0),f=e.CreateFilterFields(d);f&&f.length&&(b.Fields=b.Fields.concat(f))}return b},a.prototype.ParseFilterQueryString=function(a,b){for(var c=new Models.Entity(null),d=0;d<a.Fields.length;d++){var e=a.Fields[d],f=this.FieldTypesRegistry.GetFieldType(e.FieldTypeName,!0);f.ParseFilterQueryString(e,c,b)}return c},a.prototype.CreateFilterQueryString=function(a,b){var c="";if(!b||!b.Data)return c;for(var d=0;d<a.Fields.length;d++){for(var e=a.Fields[d],f=this.FieldTypesRegistry.GetFieldType(e.FieldTypeName,!0),g=f.CreateFilterFields(e),h=[],i=0;i<g.length;i++){var j=g[i],k=b.Data[j.FieldSystemName];h.push(k)}var l=f.CreateFilterQueryString(e,h);if(l)for(var m=0;m<l.length;m++){var n=l[m];n&&(c+=(c?"&":"")+n)}}return c},a}();a.FilterConverterService=b}(Services||(Services={}));var _global=this,Services;!function(a){var b=function(){function a(){this.Resources=_global.Localization.Resources,a.Resources=_global.Localization.Resources}return a.injection=function(){return[a]},a.prototype.GetResourceByKey=function(a,b){return this.Resources[a].format(b)},a}();a.LocalizationService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b,c){this.Q=a,this.Http=b,this.StateService=c}return a.injection=function(){return["$q","$http","StateService",a]},a.prototype.AnonymousGet=function(a,b){return this.DoHttpOperation(!1,!0,"GET",a,b,null)},a.prototype.AnonymousPost=function(a,b,c){return this.DoHttpOperation(!1,!0,"POST",a,b,c)},a.prototype.Get=function(a,b){return this.DoHttpOperation(!0,!0,"GET",a,b,null)},a.prototype.Put=function(a,b,c){return this.DoHttpOperation(!0,!1,"PUT",a,b,c)},a.prototype.Post=function(a,b,c,d){return void 0===d&&(d=!1),this.DoHttpOperation(!0,d,"POST",a,b,c)},a.prototype.Delete=function(a,b){return this.DoHttpOperation(!0,!1,"DELETE",a,b,null)},a.prototype.DoHttpOperation=function(a,b,c,d,e,f){var g=this.Q.defer(),h=a?this.CreateAfterLoginRetryFunctionFor(g,b,c,d,e,f):null,i=this.StateService.GetCurrentUserSession();if(!i&&a)this.HandleUnauthenticatedUser(g,h);else{var j=this.CreateRequestConfigFor(i),k=["POST","PUT"].contains(c),l=c.toLowerCase(),m=this.Http[l](d,k?f:j,k?j:null);this.ChainPromises(g,m,h)}return g.promise},a.prototype.CreateRequestConfigFor=function(a){return a?{headers:{"X-BF-Auth-User":a.User.UserName,"X-BF-Auth-Valid-To":a.ValidTo,"X-BF-Auth-Token":a.Token}}:{}},a.prototype.CreateAfterLoginRetryFunctionFor=function(a,b,c,d,e,f){var g=this,h=!b,i=function(){var h=g.DoHttpOperation(!0,b,c,d,e,f);g.ChainPromises(a,h,null)},j=function(){a.reject({Type:"Cancellation"})};return{actionName:e,canCancel:h,retryFunction:i,cancelFunction:h?j:null}},a.prototype.ChainPromises=function(a,b,c){var d=this,e=function(b,c,d,e){a.resolve(b)},f=function(b,e,f,g){return 401===e?void d.HandleUnauthenticatedUser(a,c):void a.reject(b)};void 0!==b.success?b.success(e).error(f):b.then(e,f)},a.prototype.HandleUnauthenticatedUser=function(a,b){b?this.StateService.RegisterPostLoginAction(b.actionName,b.canCancel,b.retryFunction,b.cancelFunction):a.reject(null,{Type:"Client",ErrorTypeKey:"UserUnauthenticated"}),this.StateService.SetCurrentUserSession(null)},a}();a.HttpWrapperService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b,c,d,e){this.HttpWrapperService=a,this.UrlLocatorService=b,this.EntityModelMapperService=c,this.QueryCreatorService=d,this.PluginsExecutorService=e}return a.injection=function(){return["HttpWrapperService","UrlLocatorService","EntityModelMapperService","QueryCreatorService","PluginsExecutorService",a]},a.prototype.LoadEntityMetadata=function(a,b){var c=this,d=this.UrlLocatorService.GetUrlForEntityMetadataRetrieve(a);this.HttpWrapperService.Get(d,"LoadAllMetadata").then(function(a){var d=c.EntityModelMapperService.DeserializeEntityMetadataModel(a);b(d,null)},function(a){b(null,a)})},a.prototype.SaveEntityMetadata=function(a,b){var c=this,d=Models.PluginContext.CreateForMetadata(a,a.CreatedDate?Static.PluginOperation.Update:Static.PluginOperation.Create);this.PluginsExecutorService.ExecuteAllPluginsFor(d,function(d){if(d.CancelPluginOperation)return void b(null,d.CancellationPluginErrorModel);var e=c.UrlLocatorService.GetUrlForEntityMetadataSave(a.EntitySystemName),f=a.CreatedDate?"CreateEntityMetadata":"UpdateEntityMetadata";c.HttpWrapperService.Post(e,f,d.Data,!1).then(function(a){var d=c.EntityModelMapperService.DeserializeEntityMetadataModel(a);b(d,null)},function(a){b(null,a)})})},a.prototype.LoadAllEntityMetadata=function(a){var b=this,c=this.UrlLocatorService.GetUrlForEntityMetadataListRetrieve();this.HttpWrapperService.Get(c,"LoadAllMetadata").then(function(c){for(var d=[],e=0;e<c.length;e++){var f=c[e],g=b.EntityModelMapperService.DeserializeEntityMetadataModel(f);d.push(g)}a(d,null)},function(b){a(null,b)})},a.prototype.LoadEntity=function(a,b,c){var d=this,e=this.UrlLocatorService.GetUrlForEntityRetrieve(a,b);this.HttpWrapperService.Get(e,"LoadEntity").then(function(a){var b=d.EntityModelMapperService.DeserializeEntityModel(a);c(b,null)},function(a){c(null,a)})},a.prototype.SaveEntity=function(a,b){var c=this,d=Models.PluginContext.CreateForEntity(a,a.CreatedDate?Static.PluginOperation.Update:Static.PluginOperation.Create);this.PluginsExecutorService.ExecuteAllPluginsFor(d,function(d){if(d.CancelPluginOperation)return void b(null,d.CancellationPluginErrorModel);var e=c.UrlLocatorService.GetUrlForEntitySave(a.EntitySystemName),f=a.Id?"CreateEntity":"UpdateEntity";c.HttpWrapperService.Post(e,f,d.Data,!1).then(function(a){var d=c.EntityModelMapperService.DeserializeEntityModel(a);b(d,null)},function(a){b(null,a)})})},a.prototype.DeleteEntity=function(a,b){var c=this,d=Models.PluginContext.CreateForEntity(a,Static.PluginOperation.Delete);this.PluginsExecutorService.ExecuteAllPluginsFor(d,function(d){if(d.CancelPluginOperation)return void b(null,d.CancellationPluginErrorModel);var e=c.UrlLocatorService.GetUrlForEntityDelete(a.EntitySystemName,a.Id);c.HttpWrapperService.Delete(e,"DeleteEntity").then(function(){b(a,null)},function(a){b(null,a)})})},a.prototype.LoadAllEntities=function(a,b){var c=this,d=this.UrlLocatorService.GetUrlForEntityListRetrieve(a);this.HttpWrapperService.Get(d,"LoadAllEntities").then(function(a){for(var d=[],e=0;e<a.length;e++){var f=a[e],g=c.EntityModelMapperService.DeserializeEntityModel(f);d.push(g)}b(d,null)},function(a){b(null,a)})},a.prototype.LoadPagedEntities=function(a,b,c,d){var e=this,f=this.UrlLocatorService.GetUrlForPagedEntityListRetrieve(a,b,c);this.HttpWrapperService.Get(f,"LoadPagedEntities").then(function(a){for(var b=[],c=0;c<a.List.length;c++){var f=a.List[c],g=e.EntityModelMapperService.DeserializeEntityModel(f);b.push(g)}a.List=b,d(a,null)},function(a){d(null,a)})},a.prototype.LoadSearchResults=function(a,b,c){var d=this,e=this.QueryCreatorService.CreateRelationSearchQuery(a,b),f=Config.Client.SearchListSize/2,g=this.UrlLocatorService.GetUrlForFilteredListRetrieve(a.EntitySystemName,0,f);this.HttpWrapperService.Post(g,"Search",e,!0).then(function(e){for(var f=[],g=0;g<e.List.length;g++){var h=e.List[g],i=d.EntityModelMapperService.GetSelectFieldOptionFromEntityJson(h,a);f.push(i)}c(b,f,e.Page.TotalCount,null)},function(a){c(b,null,null,a)})},a.prototype.LoadPagedFilteredResults=function(a,b,c,d,e){var f=this,g=this.UrlLocatorService.GetUrlForFilteredListRetrieve(a,c,d);this.HttpWrapperService.Post(g,"Filter",b,!0).then(function(a){for(var b=[],c=0;c<a.List.length;c++){var d=a.List[c],g=f.EntityModelMapperService.DeserializeEntityModel(d);b.push(g)}a.List=b,e(a,null)},function(a){e(null,a)})},a}();a.EntityRepositoryService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b,c,d){this.HttpWrapperService=a,this.UrlLocatorService=b,this.RedirectService=c,this.EntityMetadataListCacheService=d}return a.injection=function(){return["HttpWrapperService","UrlLocatorService","RedirectService","EntityMetadataListCacheService",a]},a.prototype.GetActivitySummary=function(a,b){var c=this.UrlLocatorService.GetUrlForDashboardActivitySummary(a);this.HttpWrapperService.Get(c,"DashboardActivitySummary").then(function(a){b(a,null)},function(a){b(null,a)})},a.prototype.GetMyLastActivity=function(a,b){var c=this,d=this.UrlLocatorService.GetUrlForMyLastActivity(a);this.HttpWrapperService.Get(d,"MyLastActivity").then(function(a){c.ExtendActivityList(a,function(){b(a,null)})},function(a){b(null,a)})},a.prototype.GetLastActivity=function(a,b){var c=this,d=this.UrlLocatorService.GetUrlForLastActivity(a);this.HttpWrapperService.Get(d,"LastActivity").then(function(a){c.ExtendActivityList(a,function(){b(a,null)})},function(a){b(null,a)})},a.prototype.ExtendActivityList=function(a,b){if(0===a.length)return void b();for(var c=this,d=0,e=0;e<a.length;e++){var f=a[e];c.ExtendActivityListItemModel(f,a,function(){++d===a.length&&b()})}},a.prototype.ExtendActivityListItemModel=function(a,b,c){var d=this,e=function(b){return b.Collection===a.Collection&&b.Id===a.Id&&"delete"===b.Operation};this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(a.Collection,function(f){a.EntityName=f.EntityName,a.Deleted=b.any(e),a.Url=a.Deleted?null:d.RedirectService.GetEditEntityUrl(a.Collection,a.Id),c()})},a}();a.DashboardRepositoryService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b){this.HttpWrapperService=a,this.UrlLocatorService=b}return a.injection=function(){return["HttpWrapperService","UrlLocatorService",a]},a.prototype.LoginUser=function(a,b,c,d){var e={userName:a,password:b,stayLoggedIn:c},f=this.UrlLocatorService.GetUrlForLogin();this.HttpWrapperService.AnonymousPost(f,"Login",e).then(function(a){d(a,null)},function(a){d(null,a)})},a}();a.UserRepositoryService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){this.ApiBaseUrl=Config.Client.ApiBaseUrl}return a.injection=function(){return[a]},a.prototype.AddPreventCacheParameter=function(a){return a+"?t="+(new Date).getTime()},a.prototype.GetUrlForEntityMetadataListRetrieve=function(){var a=this.ApiBaseUrl+"metadata/all";return this.AddPreventCacheParameter(a)},a.prototype.GetUrlForEntityMetadataRetrieve=function(a){var b=(this.ApiBaseUrl+"metadata/{0}/{0}").format([a]);return this.AddPreventCacheParameter(b)},a.prototype.GetUrlForEntityMetadataSave=function(a){return(this.ApiBaseUrl+"metadata/{0}").format([a])},a.prototype.GetUrlForPagedEntityListRetrieve=function(a,b,c){var d=b.toString(),e=c.toString(),f=(this.ApiBaseUrl+"entity/{0}/page/{1}/{2}").format([a,d,e]);return this.AddPreventCacheParameter(f)},a.prototype.GetUrlForFilteredListRetrieve=function(a,b,c){var d=b.toString(),e=c.toString();return(this.ApiBaseUrl+"entity/{0}/filtered/page/{1}/{2}").format([a,d,e])},a.prototype.GetUrlForEntityListRetrieve=function(a){var b=(this.ApiBaseUrl+"entity/{0}").format([a]);return this.AddPreventCacheParameter(b)},a.prototype.GetUrlForEntityRetrieve=function(a,b){var c=b.toString(),d=(this.ApiBaseUrl+"entity/{0}/{1}").format([a,c]);return this.AddPreventCacheParameter(d)},a.prototype.GetUrlForEntitySave=function(a){return(this.ApiBaseUrl+"entity/{0}").format([a])},a.prototype.GetUrlForEntityDelete=function(a,b){var c=b.toString();return(this.ApiBaseUrl+"entity/{0}/{1}").format([a,c])},a.prototype.GetUrlForLogin=function(){return this.ApiBaseUrl+"user/login"},a.prototype.GetUrlForDashboardActivitySummary=function(a){var b=this.ApiBaseUrl+"dashboard/activity/summary";return a&&(b=(this.ApiBaseUrl+"dashboard/activity/{0}/summary").format([a])),this.AddPreventCacheParameter(b)},a.prototype.GetUrlForMyLastActivity=function(a){var b=this.ApiBaseUrl+"dashboard/activity/me";return a&&(b=(this.ApiBaseUrl+"dashboard/activity/{0}/me").format([a])),this.AddPreventCacheParameter(b)},a.prototype.GetUrlForLastActivity=function(a){var b=this.ApiBaseUrl+"dashboard/activity/all";return a&&(b=(this.ApiBaseUrl+"dashboard/activity/{0}/all").format([a])),this.AddPreventCacheParameter(b)},a}();a.UrlLocatorService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){}return a.injection=function(){return[a]},a.prototype.CreateRelationSearchQuery=function(a,b){var c=function(a){return["Text","Textarea","Select"].contains(a.FieldTypeName)&&a.DisplayInListName},d=a.Fields.first(c);if(!d)return null;var e={},f="Data."+d.FieldSystemName;return"Select"===d.FieldTypeName&&(f+=".Text"),e[f]={$regex:b,$options:"i"},e},a}();a.QueryCreatorService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b){this.LocalizationService=a,this.MessagingService=b}return a.injection=function(){return["LocalizationService","MessagingService",a]},a.prototype.NotifyMessage=function(a,b){this.MessagingService.Messages.Notification.Message.publish(a,b)},a.prototype.Notify=function(a,b,c){var d=this.LocalizationService.GetResourceByKey(a,b);this.NotifyMessage(d,c)},a.prototype.HandleErrorsModel=function(a){if(null!==a&&"Plugin"===a.Type)this.NotifyMessage(a.PluginMessage,Static.NotificationSeverity.Warning);else if(null!=a&&"Client"===a.Type)for(var b=0;b<a.Errors.length;b++){var c=a.Errors[b];this.Notify(c.ErrorTypeKey,c.ErrorParameters,Static.NotificationSeverity.Error)}else null!==a&&"Cancellation"===a.Type||this.NotifyMessage(this.LocalizationService.Resources.UnknownError,Static.NotificationSeverity.Error)},a}();a.NotificationService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){this.IsLoading=!1}return a.prototype.InvalidateCache=function(){throw new Error},a.prototype.LoadData=function(a){throw new Error},a.prototype.LoadDataCompleted=function(a,b){throw new Error},a}();a.CacheBaseService=b}(Services||(Services={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Services;!function(a){var b=function(a){function b(b,c,d){a.call(this),this.MessagingService=b,this.EntityRepositoryService=c,this.NotificationService=d,this.Setup()}return __extends(b,a),b.injection=function(){return["MessagingService","EntityRepositoryService","NotificationService",b]},b.prototype.Setup=function(){this.RegisterDependencies(),this.WatchForChanges(),this.LoadData(null),_global.Instances=_global.Instances||{},_global.Instances.EntityMetadataListCacheService=this},b.prototype.RegisterDependencies=function(){},b.prototype.WatchForChanges=function(){this.MessagingService.Messages.Metadata.Created.subscribe(this.EntityMetadataCreatedOrModified.bind(this)),this.MessagingService.Messages.Metadata.Modified.subscribe(this.EntityMetadataCreatedOrModified.bind(this))},b.prototype.EntityMetadataCreatedOrModified=function(a){if(null!=this.Data){var b=function(b){return b.EntitySystemName===a.EntitySystemName},c=this.Data.single(b);if(c){var d=this.Data.indexOf(c);c.Fields=a.Fields,c.ModifiedDate=a.ModifiedDate,this.Data.splice(d,1),this.Data.unshift(c)}else this.Data.unshift(a);this.MessagingService.Messages.Cache.MetadataList.Loaded.publish(this.Data)}},b.prototype.InvalidateCache=function(){this.Data=null,this.LoadData(null),this.MessagingService.Messages.Cache.MetadataList.Invalidated.publish()},b.prototype.LoadData=function(a){this.IsLoading=!0,this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityMetadataListCache),this.EntityRepositoryService.LoadAllEntityMetadata(this.LoadDataCompleted.bind(this))},b.prototype.LoadDataCompleted=function(a,b){null==b?(this.Data=a,this.MessagingService.Messages.Cache.MetadataList.Loaded.publish(a)):this.NotificationService.HandleErrorsModel(b),this.IsLoading=!1,this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityMetadataListCache)},b.prototype.LoadEntityMetadataFromCache=function(a,b){var c=function(b){return b.EntitySystemName===a};if(this.IsLoading)var d=this.MessagingService.Messages.Cache.MetadataList.Loaded.subscribe(function(a){d();var e=a.single(c);b(e,null)});else{var e=this.Data.single(c);b(e,null)}},b}(a.CacheBaseService);a.EntityMetadataListCacheService=b}(Services||(Services={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);
c.prototype=b.prototype,a.prototype=new c},Services;!function(a){var b=function(a){function b(b,c,d,e){a.call(this),this.MessagingService=b,this.EntityRepositoryService=c,this.NotificationService=d,this.LocalizationService=e,this.PageSize=Config.Client.EntityListPageSize,this.RegisterDependencies()}return __extends(b,a),b.injection=function(){return["MessagingService","EntityRepositoryService","NotificationService","LocalizationService",b]},b.prototype.InvalidateCache=function(){this.Data=null,this.TotalCount=null,this.TotalPages=null,this.VersionIdentifier=null,this.MessagingService.Messages.Cache.EntityList.Invalidated.publish(this.EntitySystemName)},b.prototype.LoadData=function(a){this.IsLoading&&this.EntitySystemName===a.EntitySystemName&&Object.haveEqualData(this.Query,a.Query)||(this.IsLoading=!0,a.HasCurrent||this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityListCache),this.EntityRepositoryService.LoadPagedFilteredResults(this.EntitySystemName,a.Query,a.PageIndex,a.PageSize,this.LoadDataCompleted.bind(this)))},b.prototype.LoadDataCompleted=function(a,b){if(null===b){if(null!==a&&(this.EntitySystemName!==a.EntitySystemName||!Object.haveEqualData(this.Query,a.Query)))return;if((this.TotalCount!==a.Page.TotalCount||this.VersionIdentifier!==a.Page.VersionIdentifier)&&(this.InvalidateCache(),this.TotalCount=a.Page.TotalCount,this.TotalPages=a.Page.TotalPages,this.VersionIdentifier=a.Page.VersionIdentifier,this.Data=new Array(this.TotalCount)),a.Page.PageIndex<0||0!==a.Page.PageIndex&&a.Page.PageIndex>=a.Page.TotalPages)this.NotificationService.NotifyMessage(this.LocalizationService.Resources.NonExistingPage,Static.NotificationSeverity.Warning);else if(a.List.length!==a.Page.LoadedCount||a.Page.StartIndex+a.Page.LoadedCount>a.Page.TotalCount)this.NotificationService.NotifyMessage(this.LocalizationService.Resources.InvalidDataLoaded,Static.NotificationSeverity.Error);else for(var c=0;c<a.List.length;c++)this.Data[a.Page.StartIndex+c]=a.List[c];this.MessagingService.Messages.Cache.EntityList.DataLoaded.publish(a)}else this.NotificationService.HandleErrorsModel(b);this.IsLoading=!1,this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityListCache)},b.prototype.LoadEntityListPage=function(a,b,c,d){var e=this.AssertEntityPageInCache(a,b,c);if(e)d(e,b,c,this.TotalPages,null);else var f=this,g=this.MessagingService.Messages.Cache.EntityList.DataLoaded.subscribe(function(e){if(e.EntitySystemName===a&&Object.haveEqualData(b,e.Query)&&e.Page.PageIndex===c)if(g(),f.HasPageData(c)){var h=f.GetPageData(c);d(h,b,c,f.TotalPages,null)}else d(null,b,c,null,{Type:"Client",Errors:[{ErrorTypeKey:"FindPagedError",ErrorParameters:[f.EntitySystemName,c+1]}]})})},b.prototype.EntityCreatedHandler=function(a){a.EntitySystemName===this.EntitySystemName&&(this.Data.unshift(a),this.TotalCount=this.Data.length,this.TotalPages=Math.ceil(this.TotalCount/this.PageSize),this.MessagingService.Messages.Cache.EntityList.Changed.publish(this.EntitySystemName))},b.prototype.EntityModifiedHandler=function(a){var b=function(b){return b&&b.EntitySystemName===a.EntitySystemName&&b.Id===a.Id},c=this.Data.single(b);c?(this.Data.remove(c),this.Data.unshift(a),this.TotalCount=this.Data.length,this.TotalPages=Math.ceil(this.TotalCount/this.PageSize),this.MessagingService.Messages.Cache.EntityList.Changed.publish(this.EntitySystemName)):this.InvalidateCache()},b.prototype.RegisterDependencies=function(){this.MessagingService.Messages.Entity.Created.subscribe(this.EntityCreatedHandler.bind(this)),this.MessagingService.Messages.Entity.Modified.subscribe(this.EntityModifiedHandler.bind(this)),this.MessagingService.Messages.Entity.Deleted.subscribe(this.EntityDeletedHandler.bind(this))},b.prototype.EntityDeletedHandler=function(a){var b=function(b){return b&&b.EntitySystemName===a.EntitySystemName&&b.Id===a.Id},c=this.Data.single(b);if(c){var d=this.Data.indexOf(c);this.Data.splice(d,1),this.TotalCount=this.Data.length,this.TotalPages=Math.ceil(this.TotalCount/this.PageSize),this.MessagingService.Messages.Cache.EntityList.Changed.publish(this.EntitySystemName)}else this.InvalidateCache()},b.prototype.AssertEntityPageInCache=function(a,b,c){this.EntitySystemName===a&&Object.haveEqualData(this.Query,b)||(this.InvalidateCache(),this.EntitySystemName=a,this.Query=b);var d=this.HasPageData(c),e=0===c||this.HasPageData(c-1),f=c+1===this.TotalPages||this.HasPageData(c+1),g=d&&e&&f;return g||this.LoadData({EntitySystemName:a,Query:b,PageIndex:c,PageSize:this.PageSize,HasCurrent:d}),d?this.GetPageData(c):null},b.prototype.HasPageData=function(a){if(null===this.Data||null===this.TotalCount)return!1;var b=this.GetPageIndexes(a);if(null===b)return!1;for(var c=b.StartIndex;c<b.EndIndex;c++)if(!this.Data[c])return!1;return!0},b.prototype.GetPageData=function(a){var b=this.GetPageIndexes(a);return null===b?null:this.Data.slice(b.StartIndex,b.EndIndex)},b.prototype.GetPageIndexes=function(a){var b=a*this.PageSize,c=(a+1)*this.PageSize;return 0>b||0>c?null:b>this.Data.length?null:(c>this.Data.length&&(c=this.Data.length),{StartIndex:b,EndIndex:c})},b}(a.CacheBaseService);a.EntityListCacheService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){this.UserSessionKey="UserSession"}return a.injection=function(){return[a]},a.prototype.SaveUserSession=function(a){this.SaveObject(this.UserSessionKey,a)},a.prototype.LoadUserSession=function(){return this.LoadObject(this.UserSessionKey)},a.prototype.LoadObject=function(a){if(localStorage){var b=localStorage.getItem(a);return b?JSON.parse(b):null}return null},a.prototype.SaveObject=function(a,b){if(localStorage){var c=JSON.stringify(b);localStorage.setItem(a,c)}},a}();a.PersistentStorageService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b,c,d,e){this.MessagingService=a,this.DialogService=b,this.RedirectService=c,this.LocalizationService=d,this.PersistentStorageService=e,this.EditedEntity=null,this.CurrentUserSession=null,this.PostLoginActions=[],this.Initialize()}return a.injection=function(){return["MessagingService","DialogService","RedirectService","LocalizationService","PersistentStorageService",a]},a.prototype.SetEditedEntity=function(a){this.EditedEntity=a},a.prototype.GetEditedEntity=function(a,b){return this.EditedEntity&&this.EditedEntity.EntitySystemName===a&&this.EditedEntity.Id===b||(this.EditedEntity=null),this.EditedEntity},a.prototype.SetCurrentUserSession=function(a){var b=this.CurrentUserSession;this.CurrentUserSession=a,this.UpdateSavedUserSession(a),a?(this.MessagingService.Messages.User.LoggedIn.publish(a),this.PostLoginHandler()):this.MessagingService.Messages.User.LoggedOut.publish(b)},a.prototype.GetCurrentUserSession=function(){return this.CurrentUserSession},a.prototype.UpdateCurrentUserSession=function(a,b){var c=this.CurrentUserSession;c&&c.ValidTo<a&&(c.ValidTo=a,c.Token=b),this.UpdateSavedUserSession(c)},a.prototype.RegisterPostLoginAction=function(a,b,c,d){var e=this.CurrentUserSession;this.PostLoginActions.add({registeringUser:e&&e.User.UserName,actionName:a,canCancel:b,action:c,cancel:d})},a.prototype.PostLoginHandler=function(){var a=this,b=this.CurrentUserSession,c=function(a){return!a.registeringUser||a.registeringUser===b.User.UserName},d=function(a){return a.canCancel},e=this.PostLoginActions.where(c);if(this.PostLoginActions=[],0!==e.length){var f=e.where(d),g=f&&f.length>0;if(g){var h=this.CreateClientReadableActionsList(f);this.DialogService.CreateConfirmationDialog(h,function(b){a.ExecutePostLoginActions(e,b),b||a.RedirectService.RedirectToHomeScreen()})}else this.ExecutePostLoginActions(e,!1)}},a.prototype.CreateClientReadableActionsList=function(a){for(var b=[this.LocalizationService.Resources.RetryActionsQuestion],c=0;c<a.length;c++){var d=a[c];b.push(this.LocalizationService.GetResourceByKey(d.actionName,null))}return b},a.prototype.ExecutePostLoginActions=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.action,f=d.cancel,g=d.canCancel;!g||b?e():f()}},a.prototype.Initialize=function(){var a=this.PersistentStorageService.LoadUserSession();null!==a&&this.SetCurrentUserSession(a)},a.prototype.UpdateSavedUserSession=function(a){var b=this.PersistentStorageService.LoadUserSession();null!==a&&a.StayLoggedIn?this.PersistentStorageService.SaveUserSession(a):null!==b&&this.PersistentStorageService.SaveUserSession(null)},a}();a.StateService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a,b){this.LocalizationService=a,this.MessagingService=b}return a.injection=function(){return["LocalizationService","MessagingService",a]},a.prototype.CreateConfirmationDialog=function(a,b){var c={Header:this.LocalizationService.Resources.Confirmation,Text:a,Callback:b,Buttons:[{Text:this.LocalizationService.Resources.Yes,Value:!0,ButtonType:"warning"},{Text:this.LocalizationService.Resources.No,Value:!1,ButtonType:"default"}]};this.MessagingService.Messages.Dialog.Create.publish(c)},a.prototype.RemoveDialog=function(){this.MessagingService.Messages.Dialog.Remove.publish()},a}();a.DialogService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(){}return a.injection=function(){return[a]},a.prototype.ScrollToTop=function(){document.body.scrollTop=0},a}();a.DomManipulationService=b}(Services||(Services={}));var Services;!function(a){var b=function(){function a(a){this.StateService=a}return a.injection=function(){return["StateService",a]},a.prototype.UserCanPerformGlobalAction=function(a){var b=this.StateService.GetCurrentUserSession();if(!b||!b.User)return!1;if(b.User.IsSuperUser)return!0;var c=function(b){return b.Action===a},d=b.User.ApplicationPermissions.single(c);if(null!=d)return d.Allow;for(var e=function(b){return b.Action===a&&b.Allow},f=0;f<b.User.Roles.length;f++){var g=b.User.Roles[f],h=g.ApplicationPermissions.first(e);if(null!==h)return h.Allow}return!1},a.prototype.UserCanPerformObjectAction=function(a,b){var c=this.StateService.GetCurrentUserSession();if(!c||!c.User)return!1;if(c.User.IsSuperUser)return!0;var d=function(b){return b.Action===a},e=b.Permissions.single(d);if(!e)return!1;var f=this.CheckUserPermission(a,c.User.UserName,e);if(null!==f)return f;var g=function(a){return a.RoleName},h=c.User.Roles.map(g),i=this.CheckRolesPermission(a,h,e);return null!==i?i:e.Allow},a.prototype.CheckUserPermission=function(a,b,c){var d=function(a){return a===b},e=c.AllowUsers.single(d),f=c.DenyUsers.single(d);return e?!0:f?!1:null},a.prototype.CheckRolesPermission=function(a,b,c){var d=function(a){return b.contains(a)},e=c.AllowRoles.first(d),f=c.DenyRoles.first(d);return e.length>0?!0:f.length>0?!1:null},a}();a.PermissionService=b}(Services||(Services={}));var _global=this;_global.Components=_global.Components||{},_global.Components.Plugins=[];var Services;!function(a){var b=function(){function a(a){this.LocalizationService=a,this.RegisteredPlugins=_global.Components.Plugins}return a.injection=function(){return["LocalizationService",a]},a.prototype.ExecuteAllPluginsFor=function(a,b){var c=this;if(!this.RegisteredPlugins||!this.RegisteredPlugins.length)return void b(a);var d=this.RegisteredPlugins.createCopy(),e=function(b){return b.IsPluginFor(a)},f=d.where(e),g=function(a){a.CancelPluginOperation&&(a.CancellationPluginErrorModel=c.CreatePluginCancellationErrorModel(a)),b(a)},h=function(a){return function(b){if(!f||a>=f.length||b.CancelPluginOperation)g(b);else{var c=f[a],d=h(a+1);c.Execute(b,d)}}},i=h(0);i(a)},a.prototype.CreatePluginCancellationErrorModel=function(a){var b=a.CancellationPlugin&&a.CancellationPlugin.PluginName||this.LocalizationService.Resources.UnknownPlugin,c=a.CancellationMessage,d=c?this.LocalizationService.Resources.OperationCancelledByPluginWithMessage.format([b,c]):this.LocalizationService.Resources.OperationCancelledByPlugin.format([b]);return{Type:"Plugin",PluginMessage:d}},a}();a.PluginsExecutorService=b}(Services||(Services={}));var _global=this;_global.Components=_global.Components||{},_global.Components.Plugins=[];var _global=this;_global.Components=_global.Components||{},_global.Components.FieldTypes=[];var Components;!function(a){var b;!function(a){var b=function(){function a(){this.RegisteredComponents=_global.Components.FieldTypes,_global.Instances.FieldTypesRegistry=this}return a.injection=function(){return[a]},a.prototype.GetFieldType=function(a,b){var c=function(b){return b.FieldName===a},d=function(a){return"Text"===a.FieldName},e=this.RegisteredComponents.single(c);return!e&&b?this.RegisteredComponents.single(d):e},a}();a.FieldTypesRegistry=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(a){this.Scope=a,this.Entity=a.Entity,this.FieldMetadata=a.field,this.Resources=Services.LocalizationService.Resources,this.IsValid=!1,this.WatchValue(),this.ValueChanged()}return a.prototype.GetBoundFieldValue=function(){return this.Entity.Data[this.FieldMetadata.FieldSystemName]},a.prototype.SetBoundFieldValue=function(a){this.Entity.Data[this.FieldMetadata.FieldSystemName]=a},a.prototype.WatchValue=function(){var a=this,b=function(){a.ValueChanged(),a.EntityValueChangedEvent&&a.EntityValueChangedEvent()};this.Scope.$watch("Entity.Data[field.FieldSystemName]",b),this.Scope.$watch("Entity",function(){a.Entity=a.Scope.Entity,b()})},a.prototype.ValueChanged=function(){if(!this.Entity)return void(this.IsValid=!1);var a=this.FieldMetadata,b=this.Entity.Data[a.FieldSystemName],c=a.ValidateValue(b);c?this.Entity.ErrorFields.remove(a.FieldSystemName):this.Entity.ErrorFields.add(a.FieldSystemName),this.IsValid=c,a.ValueChanged&&a.ValueChanged(b,c)},a.prototype.StopEventPropagation=function(a){a&&(a.preventDefault(),a.stopPropagation())},a.prototype.ApplyChanges=function(){this.Scope.$apply(function(){})},a}();a.BaseFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Directives;!function(a){var b=function(){function a(){}return a.DirectiveOptions=function(a,b){var c=a.toLowerCase(),d="angular/components/fieldTypes/"+c+"/template.html";return{restrict:"C",scope:"=",controller:a+"FieldController",controllerAs:c[0]+"fc",replace:!0,templateUrl:d,link:function(a,c,d){var e=b();e.Link(a,c,d)}}},a.prototype.Link=function(a,b,c){},a}();a.BaseField=b}(Directives||(Directives={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Directives;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.injectionFor=function(a){return[c.DirectiveOptionsFor(a)]},c.DirectiveOptionsFor=function(b){return function(){return a.BaseField.DirectiveOptions(b,c.StaticConstructor)}},c.StaticConstructor=function(){return new a.GenericField},c}(a.BaseField);a.GenericField=b}(Directives||(Directives={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Boolean",this.DirectiveName="fieldBoolean",this.DirectiveControllerName="BooleanFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.BooleanFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.BooleanFieldMetadata},b.prototype.FormatValue=function(a){return null===a||void 0===a?null:a?Services.LocalizationService.Resources.Yes:Services.LocalizationService.Resources.No},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.BooleanFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.BooleanFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.BooleanFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.BooleanFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateBooleanFieldFormFields.GetData()},b}();b.BooleanFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.BooleanFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Boolean"),this.FieldSpecialProperties=["ThreeState"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b}(a.FieldMetadata);a.BooleanFieldMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.ThreeStateField()]),c},b.ThreeStateField=function(){var a=new Models.BooleanFieldMetadata;return a.FieldSystemName="ThreeState",a.FieldName=Services.LocalizationService.Resources.ThreeState,a.FieldDescription=a.FieldName,a.Required=!0,a},b}();a.CreateBooleanFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.injection=function(){return["$scope",b]},b}(a.BaseFieldController);a.BooleanFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=new Models.BooleanFieldMetadata;return c.FieldSystemName=b.FieldSystemName,c.FieldName=b.FieldName,c.ThreeState=!0,c.Required=!1,[c]},a.CreateFilterQuery=function(a,b){if(!b||1!==b.length||null===b[0]||void 0===b[0])return null;var c={};return c["Data."+a.FieldSystemName]=b[0],c},a.ParseFilterQueryString=function(a,b,c){var d=c[a.FieldSystemName];"true"===d?b.Data[a.FieldSystemName]=!0:"false"===d&&(b.Data[a.FieldSystemName]=!1)},a.CreateFilterQueryString=function(a,b){if(!b||1!==b.length||null===b[0]||void 0===b[0])return null;var c=a.FieldSystemName+"="+b[0].toString();return[c]},a}();a.BooleanFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Date",this.DirectiveName="fieldDate",this.DirectiveControllerName="DateFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.DateFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.DateFieldMetadata},b.prototype.FormatValue=function(a){if(!a)return null;var b=new Date(a);return b.format(Config.Client.DatepickerFormat)},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.DateFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.DateFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.DateFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.DateFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateDateFieldFormFields.GetData()},b}();b.DateFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.DateFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Date"),this.FieldSpecialProperties=["MinDate","MaxDate"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b.prototype.ValidateValue=function(b){var c=a.prototype.ValidateValue.call(this,b);return c?b?this.MinDate&&this.MinDate>b?!1:this.MaxDate&&this.MaxDate<b?!1:!0:!0:!1},b}(a.FieldMetadata);a.DateFieldMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.MinDateField(),b.MaxDateField()]),c},b.MinDateField=function(){var a=new Models.DateFieldMetadata;return a.FieldSystemName="MinDate",a.FieldName=Services.LocalizationService.Resources.MinDate,a.FieldDescription=a.FieldName,a},b.MaxDateField=function(){var a=new Models.DateFieldMetadata;return a.FieldSystemName="MaxDate",a.FieldName=Services.LocalizationService.Resources.MaxDate,a.FieldDescription=a.FieldName,a},b}();a.CreateDateFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b),this.EntityValueChangedEvent=this.EntityValueChanged.bind(this),this.EntityValueChanged()}return __extends(b,a),b.injection=function(){return["$scope",b]},b.prototype.ToggleOpen=function(a){this.StopEventPropagation(a),this.Opened=!this.Opened},b.prototype.IsDisabled=function(a,b){var c=this.FieldMetadata.MinDate,d=this.FieldMetadata.MaxDate,e=!1;switch(a.setHours(0,0,0,0),b){case"day":var f=this.ConvertToUtcTime(a);e=c&&c>f||d&&f>d;break;case"month":var g=new Date(a.getFullYear(),a.getMonth()+1,0),h=this.ConvertToUtcTime(a),i=this.ConvertToUtcTime(g);e=c&&c>i||d&&h>d;break;case"year":var j=new Date(a.getFullYear(),11,31),k=this.ConvertToUtcTime(a),l=this.ConvertToUtcTime(j);e=c&&c>l||d&&k>d}return e},b.prototype.UIValueChanged=function(){var a=this.ConvertToUtcTime(this.LocalDate),b=this.GetBoundFieldValue();a!==b&&this.SetBoundFieldValue(a)},b.prototype.EntityValueChanged=function(){var a=this.GetBoundFieldValue(),b=this.ConvertToLocalDate(a),c=this.LocalDate;this.AreSameDate(c,b)||(this.LocalDate=b?b.toISOString():null)},b.prototype.ConvertToLocalDate=function(a){if(!a)return null;var b=new Date(a),c=b.getTimezoneOffset(),d=new Date(a+60*c*1e3);return d},b.prototype.ConvertToUtcTime=function(a){if(!a)return null;if("[object String]"===Object.prototype.toString.call(a))return this.GetBoundFieldValue();var b=a.getTimezoneOffset(),c=a.getTime()-60*b*1e3;return c},b.prototype.AreSameDate=function(a,b){return a||b?a&&b?Object.prototype.toString.call(a)!==Object.prototype.toString.call(b)?!1:a.getTime()===b.getTime():!1:!0},b}(a.BaseFieldController);a.DateFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=Services.LocalizationService.Resources,d=new Models.DateFieldMetadata;d.FieldSystemName="from_"+b.FieldSystemName,d.FieldName=c.DateFrom.format([a.FieldName]),d.Required=!1,d.MinDate=b.MinDate,d.MaxDate=b.MaxDate;var e=new Models.DateFieldMetadata;return e.FieldSystemName="to_"+b.FieldSystemName,e.FieldName=c.DateTo.format([a.FieldName]),e.Required=!1,e.MinDate=b.MinDate,e.MaxDate=b.MaxDate,[d,e]},a.CreateFilterQuery=function(a,b){if(!b||2!==b.length)return null;var c=b[0],d=b[1];if(!c&&!d)return null;var e={},f={};return c&&(f.$gte=c),d&&(f.$lte=d),e["Data."+a.FieldSystemName]=f,e},a.ParseFilterQueryString=function(a,b,c){var d=c["from_"+a.FieldSystemName];if(d){var e=Date.parse(d);b.Data["from_"+a.FieldSystemName]=e}var f=c["to_"+a.FieldSystemName];if(f){var g=Date.parse(f);b.Data["to_"+a.FieldSystemName]=g}},a.CreateFilterQueryString=function(b,c){if(!c||2!==c.length)return null;var d=c[0],e=c[1],f=[];return d&&f.push("from_"+b.FieldSystemName+"="+a.StringifyDate(d)),e&&f.push("to_"+b.FieldSystemName+"="+a.StringifyDate(e)),f},a.StringifyDate=function(a){var b=new Date(a),c=new RegExp("T[\\s\\S]+Z");return JSON.parse(JSON.stringify(b).replace(c,""))},a}();a.DateFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="List",this.DirectiveName="fieldList",this.DirectiveControllerName="ListFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.ListFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.ListFieldMetadata},b.prototype.FormatValue=function(a){return a&&a.length?a.join(", "):null},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.ListFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.ListFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.ListFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.ListFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateListFieldFormFields.GetData()},b}();b.ListFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.ListFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"List"),this.FieldSpecialProperties=["MaxRecordsCount","MaxRecordLength"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b.prototype.ValidateValue=function(a){var b=a?a.length:0,c=b>0;if(this.Required&&!c)return!1;if(b>this.MaxRecordsCount)return!1;for(var d=0;b>d;d++){if(a[d].length>(this.MaxRecordLength||1024))return!1;if(a[d].startsWith(Config.Client.SystemPrefix))return!1}return!0},b}(a.FieldMetadata);a.ListFieldMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.MaxRecordsCountField(),b.MaxRecordLengthField()]),c},b.MaxRecordsCountField=function(){var a=new Models.NumberFieldMetadata;return a.FieldSystemName="MaxRecordsCount",a.FieldName=Services.LocalizationService.Resources.MaxRecordsCount,a.FieldDescription=a.FieldName,a.AllowFloating=!1,a.MinValue=1,a.MaxValue=128,a},b.MaxRecordLengthField=function(){var a=new Models.NumberFieldMetadata;return a.FieldSystemName="MaxRecordLength",a.FieldName=Services.LocalizationService.Resources.MaxRecordLength,a.FieldDescription=a.FieldName,a.AllowFloating=!1,a.MinValue=1,a.MaxValue=1024,a},b}();a.CreateListFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.injection=function(){return["$scope",b]},b.prototype.Add=function(a){this.StopEventPropagation(a),this.SetBoundFieldValue(this.GetBoundFieldValue()||[]);var b=this.GetBoundFieldValue(),c=this.CurrentValue;c&&(b.add(c),this.ValueChanged(),this.CurrentValue=null)},b.prototype.Remove=function(a,b){this.StopEventPropagation(a);var c=this.GetBoundFieldValue();c.remove(b),this.ValueChanged()},b}(a.BaseFieldController);a.ListFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=new Models.TextFieldMetadata;return c.FieldSystemName=b.FieldSystemName,c.FieldName=b.FieldName,c.Required=!1,c.MaxLength=b.MaxRecordLength,[c]},a.CreateFilterQuery=function(a,b){if(!b||1!==b.length)return null;var c=b[0];if(!c)return null;var d={};return d["Data."+a.FieldSystemName]=c,d},a.ParseFilterQueryString=function(a,b,c){var d=c[a.FieldSystemName];d&&(b.Data[a.FieldSystemName]=d)},a.CreateFilterQueryString=function(a,b){if(!b||1!==b.length)return null;if(!b[0])return null;var c=a.FieldSystemName+"="+b[0];return[c]},a}();a.ListFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Select",this.DirectiveName="fieldSelect",this.DirectiveControllerName="SelectFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.SelectFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.SelectFieldMetadata},b.prototype.FormatValue=function(a){return a?a.Text:null},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.SelectFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.SelectFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.SelectFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.SelectFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateSelectFieldFormFields.GetData()},b}();b.SelectFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.SelectFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Select"),this.FieldSpecialProperties=[]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){this.Values?a.Data.Values=this.Values.map(function(a){return a.Text}):this.Values=b.GetSelectFieldOptionsFromArrayProperty(a.Data,"Values"),this.DefaultValue?a.Data.DefaultValue=this.DefaultValue.Text:this.DefaultValue=b.GetSelectFieldOptionFromStringProperty(a.Data,"DefaultValue")},b}(a.FieldMetadata);a.SelectFieldMetadata=b}(Models||(Models={}));var Models;!function(a){var b=function(){function a(a,b){this.Value=b||a,this.Text=a||b}return a}();a.SelectFieldOptionMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.ValuesField(),b.DefaultValueField()]),c},b.ValuesField=function(){var a=new Models.ListFieldMetadata;return a.FieldSystemName="Values",a.FieldName=Services.LocalizationService.Resources.Values,a.FieldDescription=a.FieldName,a.Required=!0,a},b.DefaultValueField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="DefaultValue",a.FieldName=Services.LocalizationService.Resources.DefaultValue,a.FieldDescription=a.FieldName,a.Required=!1,a},b}();a.CreateSelectFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b,c){a.call(this,b),this.Document=c,this.EntityValueChangedEvent=this.SetInitialData.bind(this)}return __extends(b,a),b.injection=function(){return["$scope","$document",b]},b.prototype.ToggleOpen=function(a){this.StopEventPropagation(a),this.Opened=!this.Opened,this.UpdateDocumentClickHandler()},b.prototype.SelectOption=function(a,b){this.SetBoundFieldValue(b),this.Opened=!1,this.UpdateDocumentClickHandler()},b.prototype.SetInitialData=function(){
this.GetBoundFieldValue()||this.SetBoundFieldValue(this.GetBoundFieldValue()||this.FieldMetadata.DefaultValue||new Models.SelectFieldOptionMetadata("",""))},b.prototype.UpdateDocumentClickHandler=function(){var a=this.Opened?"bind":"unbind";this.Document[a]("click",this.DocumentClick.bind(this))},b.prototype.DocumentClick=function(a){!this.Opened||a.target&&a.target.className.indexOf("dropdown-toggle")>-1||(this.Opened=!1,this.UpdateDocumentClickHandler(),this.ApplyChanges())},b}(a.BaseFieldController);a.SelectFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=Services.LocalizationService.Resources,d=new Models.SelectFieldOptionMetadata(null,null);d.Text=c.AnyValue;var e=b.Values.createCopy();e.unshift(d);var f=new Models.SelectFieldMetadata;return f.FieldSystemName=b.FieldSystemName,f.FieldName=b.FieldName,f.Required=!1,f.Values=e,f.DefaultValue=d,[f]},a.CreateFilterQuery=function(a,b){if(!b||1!==b.length)return null;var c=b[0];if(!c)return null;var d={};return d["Data."+a.FieldSystemName+".Value"]=c.Value,d},a.ParseFilterQueryString=function(a,b,c){var d=c[a.FieldSystemName];d&&(b.Data[a.FieldSystemName]=new Models.SelectFieldOptionMetadata(d,d))},a.CreateFilterQueryString=function(a,b){if(!b||1!==b.length)return null;if(!b[0]||!b[0].Value)return null;var c=a.FieldSystemName+"="+b[0].Value;return[c]},a}();a.SelectFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Text",this.DirectiveName="fieldText",this.DirectiveControllerName="TextFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor("Text")},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.TextFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.TextFieldMetadata},b.prototype.FormatValue=function(a){return a},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.TextFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.TextFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.TextFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.TextFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateTextFieldFormFields.GetData()},b}();b.TextFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.TextFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Text"),this.FieldSpecialProperties=["MaxLength","RegularExpression","MaskCharacters"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b.prototype.ValidateValue=function(b){var c=a.prototype.ValidateValue.call(this,b);if(!c)return!1;if(null!=b&&b.startsWith(Config.Client.SystemPrefix))return!1;if(this.MaxLength&&b&&this.MaxLength<b.length)return!1;var d=new RegExp(this.RegularExpression,"i");return b&&!d.test(b)?!1:!0},b}(a.FieldMetadata);a.TextFieldMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.RegularExpressionField(),b.MaxLengthField()]),c},b.RegularExpressionField=function(){var a=new Models.TextFieldMetadata;return a.FieldSystemName="RegularExpression",a.FieldName=Services.LocalizationService.Resources.RegularExpression,a.FieldDescription=a.FieldName,a},b.MaxLengthField=function(){var a=new Models.NumberFieldMetadata;return a.FieldSystemName="MaxLength",a.FieldName=Services.LocalizationService.Resources.MaxLength,a.FieldDescription=a.FieldName,a.AllowFloating=!1,a.MinValue=1,a.MaxValue=1024,a},b}();a.CreateTextFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.injection=function(){return["$scope",b]},b}(a.BaseFieldController);a.TextFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=new Models.TextFieldMetadata;return c.FieldSystemName=b.FieldSystemName,c.FieldName=b.FieldName,c.Required=!1,c.MaxLength=b.MaxLength,c.RegularExpression=b.RegularExpression,[c]},a.CreateFilterQuery=function(a,b){if(!b||1!==b.length)return null;var c=b[0];if(!c)return null;var d={};return d["Data."+a.FieldSystemName]={$regex:c,$options:"i"},d},a.ParseFilterQueryString=function(a,b,c){var d=c[a.FieldSystemName];d&&(b.Data[a.FieldSystemName]=d)},a.CreateFilterQueryString=function(a,b){if(!b||1!==b.length)return null;if(!b[0])return null;var c=a.FieldSystemName+"="+b[0];return[c]},a}();a.TextFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b,c,d){a.call(this),this.FieldName=b,this.Symbol=c,this.RegularExpression=d,this.DirectiveName="field{0}".format([this.FieldName]),this.DirectiveControllerName="{0}FieldController".format([this.FieldName])}return __extends(b,a),b.prototype.CreateMetadata=function(){var a=new Models.TextFieldMetadata;return a.Symbol=this.Symbol,a.RegularExpression=this.RegularExpression,a},b.prototype.CreateFieldForm=function(){var a=function(a){return"RegularExpression"===a.FieldSystemName},b=Data.CreateTextFieldFormFields.GetData(),c=b.Fields.single(a);return b.Fields.remove(c),b},b}(a.TextFieldComponent);a.SpecialTextFieldComponent=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.SpecialTextFieldComponent("Email","envelope","^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$"));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Textarea",this.DirectiveName="fieldTextarea",this.DirectiveControllerName="TextareaFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.TextareaFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.TextareaFieldMetadata},b.prototype.FormatValue=function(a){return a},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.TextareaFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.TextareaFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.TextareaFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.TextareaFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateTextareaFieldFormFields.GetData()},b}();b.TextareaFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.TextareaFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Textarea"),this.FieldSpecialProperties=["MaxLength"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b.prototype.ValidateValue=function(b){var c=a.prototype.ValidateValue.call(this,b);return c?null!=b&&b.startsWith(Config.Client.SystemPrefix)?!1:this.MaxLength&&b&&this.MaxLength<b.length?!1:!0:!1},b}(a.FieldMetadata);a.TextareaFieldMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.MaxLengthField()]),c},b.MaxLengthField=function(){var a=new Models.NumberFieldMetadata;return a.FieldSystemName="MaxLength",a.FieldName=Services.LocalizationService.Resources.MaxLength,a.FieldDescription=a.FieldName,a.AllowFloating=!1,a.MinValue=1,a.MaxValue=4096,a},b}();a.CreateTextareaFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.injection=function(){return["$scope",b]},b}(a.BaseFieldController);a.TextareaFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=new Models.TextFieldMetadata;return c.FieldSystemName=b.FieldSystemName,c.FieldName=b.FieldName,c.Required=!1,c.MaxLength=b.MaxLength,[c]},a.CreateFilterQuery=function(a,b){if(!b||1!==b.length)return null;var c=b[0];if(!c)return null;var d={};return d["Data."+a.FieldSystemName]={$regex:c,$options:"i"},d},a.ParseFilterQueryString=function(a,b,c){var d=c[a.FieldSystemName];d&&(b.Data[a.FieldSystemName]=d)},a.CreateFilterQueryString=function(a,b){if(!b||1!==b.length)return null;if(!b[0])return null;var c=a.FieldSystemName+"="+b[0];return[c]},a}();a.TextareaFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Number",this.DirectiveName="fieldNumber",this.DirectiveControllerName="NumberFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.NumberFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.NumberFieldMetadata},b.prototype.FormatValue=function(a){return a},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.NumberFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.NumberFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.NumberFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.NumberFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateNumberFieldFormFields.GetData()},b}();b.NumberFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.NumberFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Number"),this.FieldSpecialProperties=["AllowFloating","MinValue","MaxValue"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b.prototype.ValidateValue=function(b){var c=a.prototype.ValidateValue.call(this,b);return c?b?isNaN(b)?!1:b%1===0||this.AllowFloating?b<this.MinValue?!1:b>this.MaxValue?!1:!0:!1:!0:!1},b}(a.FieldMetadata);a.NumberFieldMetadata=b}(Models||(Models={}));var Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.AllowFloatingField(),b.MinValueField(),b.MaxValueField()]),c},b.AllowFloatingField=function(){var a=new Models.BooleanFieldMetadata;return a.FieldSystemName="AllowFloating",a.FieldName=Services.LocalizationService.Resources.AllowFloating,a.FieldDescription=a.FieldName,a.Required=!0,a},b.MinValueField=function(){var a=new Models.NumberFieldMetadata;return a.FieldSystemName="MinValue",a.FieldName=Services.LocalizationService.Resources.MinValue,a.FieldDescription=a.FieldName,a.AllowFloating=!0,a},b.MaxValueField=function(){var a=new Models.NumberFieldMetadata;return a.FieldSystemName="MaxValue",a.FieldName=Services.LocalizationService.Resources.MaxValue,a.FieldDescription=a.FieldName,a.AllowFloating=!0,a},b}();a.CreateNumberFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b),this.EntityValueChangedEvent=this.EntityValueChanged.bind(this),this.EntityValueChanged()}return __extends(b,a),b.injection=function(){return["$scope",b]},b.prototype.UIValueChanged=function(){var a=this.Value,b=parseFloat(this.Value);this.SetBoundFieldValue(b||a||null)},b.prototype.EntityValueChanged=function(){var a=parseFloat(this.Value),b=this.GetBoundFieldValue();a!==b&&(this.Value=b&&b.toString())},b}(a.BaseFieldController);a.NumberFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=Services.LocalizationService.Resources,d=new Models.NumberFieldMetadata;d.FieldSystemName="from_"+b.FieldSystemName,d.FieldName=c.NumberFrom.format([a.FieldName]),d.Required=!1,d.MinValue=b.MinValue,d.MaxValue=b.MaxValue;var e=new Models.NumberFieldMetadata;return e.FieldSystemName="to_"+b.FieldSystemName,e.FieldName=c.NumberTo.format([a.FieldName]),e.Required=!1,e.MinValue=b.MinValue,e.MaxValue=b.MaxValue,[d,e]},a.CreateFilterQuery=function(a,b){if(!b||2!==b.length)return null;var c=b[0],d=b[1];if(!c&&!d)return null;var e={},f={};return c&&(f.$gte=c),d&&(f.$lte=d),e["Data."+a.FieldSystemName]=f,e},a.ParseFilterQueryString=function(a,b,c){var d=c["from_"+a.FieldSystemName];if(d){var e=parseFloat(d);b.Data["from_"+a.FieldSystemName]=e}var f=c["to_"+a.FieldSystemName];if(f){var g=parseFloat(f);b.Data["to_"+a.FieldSystemName]=g}},a.CreateFilterQueryString=function(a,b){if(!b||2!==b.length)return null;var c=b[0],d=b[1],e=[];return c&&e.push("from_"+a.FieldSystemName+"="+c),d&&e.push("to_"+a.FieldSystemName+"="+d),e},a}();a.NumberFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(b){var c=function(){function b(){this.FieldName="Relation",this.DirectiveName="fieldRelation",this.DirectiveControllerName="RelationFieldController"}return b.prototype.DirectiveOptions=function(){return Directives.GenericField.injectionFor(this.FieldName)},b.prototype.DirectiveControllerOptions=function(){return a.FieldTypes.RelationFieldController.injection()},b.prototype.CreateMetadata=function(){return new Models.RelationFieldMetadata},b.prototype.FormatValue=function(a){return a?a.Text:null},b.prototype.CreateFilterFields=function(b){return a.FieldTypes.RelationFieldFilter.CreateFilterFields(b)},b.prototype.CreateFilterQuery=function(b,c){return a.FieldTypes.RelationFieldFilter.CreateFilterQuery(b,c)},b.prototype.ParseFilterQueryString=function(b,c,d){return a.FieldTypes.RelationFieldFilter.ParseFilterQueryString(b,c,d)},b.prototype.CreateFilterQueryString=function(b,c){return a.FieldTypes.RelationFieldFilter.CreateFilterQueryString(b,c)},b.prototype.CreateFieldForm=function(){return Data.CreateRelationFieldFormFields.GetData()},b}();b.RelationFieldComponent=c}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={})),_global.Components.FieldTypes.push(new Components.FieldTypes.RelationFieldComponent);var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Models;!function(a){var b=function(a){function b(){a.call(this,"Relation"),this.FieldSpecialProperties=["RelatedEntity"]}return __extends(b,a),b.prototype.MapAdditionalProperties=function(a,b){},b}(a.FieldMetadata);a.RelationFieldMetadata=b}(Models||(Models={}));var _global=this,Data;!function(a){var b=function(){function b(){}return b.GetData=function(){var c=a.CreateFieldFormFields.GetData(null);return c.Fields=c.Fields.concat([b.RelatedEntityField()]),c},b.RelatedEntityField=function(){var a=new Models.SelectFieldMetadata;a.FieldSystemName="RelatedEntity",a.FieldName=Services.LocalizationService.Resources.RelatedEntity,a.FieldDescription=a.FieldName,a.Required=!0,a.Values=[];var b=_global.Instances.EntityMetadataListCacheService;return angular.forEach(b.Data,function(b,c){var d=new Models.SelectFieldOptionMetadata(b.EntityName,b.EntitySystemName);a.Values.add(d)}),a},b}();a.CreateRelationFieldFormFields=b}(Data||(Data={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Components;!function(a){var b;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b),this.EntityRepositoryService=c,this.EntityMetadataListCacheService=d,this.RedirectService=e}return __extends(b,a),b.injection=function(){return["$scope","EntityRepositoryService","EntityMetadataListCacheService","RedirectService",b]},b.prototype.ScheduleSearch=function(){var a=this;this.SearchResults=null,this.SearchTimer&&(clearTimeout(this.SearchTimer),this.SearchTimer=null),this.SearchExpression&&this.SearchExpression.length>=Config.Client.SearchMinExpressionLength&&(this.SearchTimer=setTimeout(function(){a.SearchTimer=null,a.SearchForEntity(a.SearchExpression)},Config.Client.SearchTypingWaitTimeMs))},b.prototype.SelectItem=function(a){this.SetBoundFieldValue(a),this.SearchExpression=null,this.SearchResults=null},b.prototype.GetFollowItemUrl=function(a){if(!a)return null;var b=parseInt(a.Value,10);return this.RedirectService.GetEditEntityUrl(this.Entity.EntitySystemName,b)},b.prototype.SearchForEntity=function(a){var b=this;b.EntityMetadataListCacheService.LoadEntityMetadataFromCache(b.FieldMetadata.RelatedEntity.Value,function(c){b.EntityRepositoryService.LoadSearchResults(c,a,b.SearchForEntityCompleted.bind(b))})},b.prototype.SearchForEntityCompleted=function(a,b,c,d){a===this.SearchExpression&&(this.SearchResults=b,this.SearchResults.HasError=null!=d,this.SearchResults.MoreResults=c-b.length)},b}(a.BaseFieldController);a.RelationFieldController=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Components;!function(a){var b;!function(a){var b=function(){function a(){}return a.CreateFilterFields=function(a){var b=a,c=new Models.RelationFieldMetadata;return c.FieldSystemName=b.FieldSystemName,c.FieldName=b.FieldName,c.Required=!1,c.RelatedEntity=b.RelatedEntity,[c]},a.CreateFilterQuery=function(a,b){if(!b||1!==b.length)return null;var c=b[0];if(!c)return null;var d={};return d["Data."+a.FieldSystemName+".Value"]=c.Value,d},a.ParseFilterQueryString=function(a,b,c){var d=c[a.FieldSystemName+"_val"],e=c[a.FieldSystemName+"_txt"];d&&(b.Data[a.FieldSystemName]=new Models.SelectFieldOptionMetadata(e,d))},a.CreateFilterQueryString=function(a,b){if(!b||1!==b.length)return null;if(!b[0]||!b[0].Value)return null;var c=a.FieldSystemName+"_val="+b[0].Value,d=a.FieldSystemName+"_txt="+b[0].Text;return[c,d]},a}();a.RelationFieldFilter=b}(b=a.FieldTypes||(a.FieldTypes={}))}(Components||(Components={}));var Controllers;!function(a){var b=function(){function a(a){this.Scope=a,this.Subscriptions=[],this.SetupBaseController()}return a.prototype.AddSubscription=function(a){this.Subscriptions.push(a)},a.prototype.SetupBaseController=function(){this.Scope.$on("$destroy",this.RemoveAllSubscriptions.bind(this))},a.prototype.RemoveAllSubscriptions=function(){for(var a=this,b=0;b<a.Subscriptions.length;b++){var c=this.Subscriptions[b];c()}this.Subscriptions=[]},a}();a.BaseController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g){a.call(this,b),this.ControllerArea=c,this.MessagingService=d,this.NotificationService=e,this.QueueService=f,this.StateService=g,this.SetupBaseViewController()}return __extends(b,a),b.prototype.SetupBaseViewController=function(){this.DeleteInvalidState(),this.RemovePendingDialog(),this.NotifyAllWaitingMessages(),this.SetConfiguration()},b.prototype.DeleteInvalidState=function(){this.ControllerArea!==Static.ControllerArea.Entity&&this.StateService.SetEditedEntity(null)},b.prototype.RemovePendingDialog=function(){this.MessagingService.Messages.Dialog.Remove.publish()},b.prototype.NotifyAllWaitingMessages=function(){var a=this.QueueService.Queues.NextPage.Notifications.retrieveAll();if(a&&0!==a.length)for(var b=0;b<a.length;b++){var c=a[b];this.NotificationService.NotifyMessage(c.Message,c.Severity)}},b.prototype.SetConfiguration=function(){this.Scope.Configuration={List:{MoveEnabled:this.ControllerArea===Static.ControllerArea.Metadata,EditEnabled:!0,DeleteEnabled:!0}}},b}(a.BaseController);a.BaseViewController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g){a.call(this,b,c,d,e,f,g),this.SetupBaseListController()}return __extends(b,a),b.prototype.SetupBaseListController=function(){this.Scope.SortListeners={},this.Scope.SortListeners.orderChanged=this.ListItemOrderChanged.bind(this)},b.prototype.ListItemOrderChanged=function(a){var b=a.dest.index,c=a.source.index;this.Scope.OriginalMetadata&&(this.Scope.OriginalMetadata.Fields.move(c,b),this.Scope.SaveEntityMetadata(this.Scope.OriginalMetadata))},b}(a.BaseViewController);a.BaseListController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){a.call(this,b),this.MessagingService=c,this.StateService=d,this.DialogService=e,this.LocalizationService=f,this.UserRepositoryService=g,this.NotificationService=h,this.MessagingService.Messages.User.LoggedIn.subscribe(this.LoggedInUserChanged.bind(this)),this.MessagingService.Messages.User.LoggedOut.subscribe(this.LoggedInUserChanged.bind(this)),this.LoggedInUserChanged(null)}return __extends(b,a),b.injection=function(){return["$scope","MessagingService","StateService","DialogService","LocalizationService","UserRepositoryService","NotificationService",b]},b.prototype.LoggedInUserChanged=function(a){var b=this.StateService.GetCurrentUserSession();b||this.DialogService.RemoveDialog(),this.InitializeScope(a&&a.User.UserName),this.Scope.LoggedInUser=!!b},b.prototype.InitializeScope=function(a){this.Scope.Login=this.Login.bind(this),this.Scope.LoginInProgress=!1,this.Scope.LoginHeader=this.LocalizationService.Resources.Login,this.Scope.LoginButtonText=this.LocalizationService.Resources.Login,this.Scope.EntityMetadata=Data.CreateLoginFormFields.GetData(),this.Scope.Entity=new Models.Entity(this.Scope.EntityMetadata.EntitySystemName),this.Scope.Entity.Data.StayLoggedIn=!1,a&&(this.Scope.Entity.Data.UserName=a)},b.prototype.Login=function(){var a=this.Scope.Entity.Data.UserName,b=this.Scope.Entity.Data.Password,c=this.Scope.Entity.Data.StayLoggedIn;this.Scope.LoginInProgress=!0,this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.LoggingIn),this.UserRepositoryService.LoginUser(a,b,c,this.LoginCompleted.bind(this))},b.prototype.LoginCompleted=function(a,b){this.Scope.LoginInProgress=!1,this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.LoggingIn),null===b?this.StateService.SetCurrentUserSession(a):(this.Scope.Entity.Data.Password=null,this.NotificationService.HandleErrorsModel(b))},b}(a.BaseController);a.LoginController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f){a.call(this,b),this.MessagingService=c,this.EntityMetadataListCacheService=d,this.LocalizationService=e,this.NotificationService=f,this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","MessagingService","EntityMetadataListCacheService","LocalizationService","NotificationService",b]},b.prototype.InitializeScope=function(){this.Scope.CreateNewEntityTitle=this.LocalizationService.Resources.CreateNewEntity,this.RetrieveDataFromEntityMetadataCache(),this.WatchEntityMetadataCache()},b.prototype.RetrieveDataFromEntityMetadataCache=function(){this.Scope.Entities=this.EntityMetadataListCacheService.Data},b.prototype.WatchEntityMetadataCache=function(){this.AddSubscription(this.MessagingService.Messages.Cache.MetadataList.Loaded.subscribe(this.RetrieveDataFromEntityMetadataCache.bind(this)))},b}(a.BaseController);a.MenuController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d){a.call(this,b),this.MessagingService=c,this.StateService=d,this.Initialize()}return __extends(b,a),b.injection=function(){return["$scope","MessagingService","StateService",b]},b.prototype.Initialize=function(){this.TasksInProgress=[],this.SetLoadingState(),this.AddSubscription(this.MessagingService.Messages.Loading.Started.subscribe(this.LoadingStarted.bind(this))),this.AddSubscription(this.MessagingService.Messages.Loading.Finished.subscribe(this.LoadingFinished.bind(this))),this.AddSubscription(this.MessagingService.Messages.Loading.Reset.subscribe(this.LoadingReset.bind(this))),this.AddSubscription(this.MessagingService.Messages.User.LoggedOut.subscribe(this.SetLoadingState.bind(this))),this.AddSubscription(this.MessagingService.Messages.User.LoggedIn.subscribe(this.SetLoadingState.bind(this)))},b.prototype.LoadingStarted=function(a){var b=this.TasksInProgress.indexOf(a);0>b&&this.TasksInProgress.add(a),this.SetLoadingState()},b.prototype.LoadingFinished=function(a){var b=this.TasksInProgress.indexOf(a);b>=0&&this.TasksInProgress.remove(a),this.SetLoadingState()},b.prototype.LoadingReset=function(){this.TasksInProgress=[],this.SetLoadingState()},b.prototype.SetLoadingState=function(){var a=this.StateService.GetCurrentUserSession(),b=!a,c=this.TasksInProgress.contains(Static.LoadingType.LoggingIn),d=this.TasksInProgress.length>0;this.Scope.LoadingInProgress=!b&&d||b&&c},b}(a.BaseController);a.LoadingController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c){a.call(this,b),this.MessagingService=c,this.Initialize(),this.RegisterListeners()}return __extends(b,a),b.injection=function(){return["$scope","MessagingService",b]},b.prototype.Initialize=function(){this.Scope.ResultDialog=this.ResultDialog.bind(this),this.Scope.Dialog=null},b.prototype.RegisterListeners=function(){this.MessagingService.Messages.Dialog.Create.subscribe(this.CreateDialog.bind(this)),this.MessagingService.Messages.Dialog.Remove.subscribe(this.RemoveDialog.bind(this))},b.prototype.CreateDialog=function(a){this.RemoveDialog(),this.Scope.Dialog=a},b.prototype.ResultDialog=function(a){this.Scope.Dialog.Callback(a),this.Scope.Dialog=null},b.prototype.RemoveDialog=function(){this.Scope.Dialog&&this.ResultDialog(null)},b}(a.BaseController);a.DialogController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f){a.call(this,b),this.Toaster=c,this.ToasterConfig=d,this.MessagingService=e,this.LocalizationService=f,this.ConfigureToastr(),this.Initialize()}return __extends(b,a),b.injection=function(){return["$scope","toaster","toasterConfig","MessagingService","LocalizationService",b]},b.prototype.Initialize=function(){this.AddSubscription(this.MessagingService.Messages.Notification.Message.subscribe(this.NotificationMessageReceived.bind(this)))},b.prototype.ConfigureToastr=function(){this.ToasterConfig["close-button"]=!0,this.ToasterConfig["time-out"]=Config.Client.NotificationDisplayTimeMs,this.ToasterConfig["position-class"]="toast-bottom-full-width"},b.prototype.NotificationMessageReceived=function(a){var b,c=(new Date).format("dd.MM.yyyy HH:mm:ss");switch(a.Severity){case Static.NotificationSeverity.Error:b=this.LocalizationService.Resources.Error,this.Toaster.pop("error",null,a.Message);break;case Static.NotificationSeverity.Warning:b=this.LocalizationService.Resources.Warning,this.Toaster.pop("warning",null,a.Message);break;case Static.NotificationSeverity.Information:b=this.LocalizationService.Resources.Information,this.Toaster.pop("info",null,a.Message);break;case Static.NotificationSeverity.Success:b=this.LocalizationService.Resources.Success,this.Toaster.pop("success",null,a.Message);break;default:throw new Error}var d="{0} - {1}: {2}".format([c,b,a.Message]);console.log(d)},b}(a.BaseController);a.NotificationController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c){a.call(this,b),this.Route=c,this.Scope.Metadata=c.current.data.metadata,this.Scope.Create=c.current.data.create}return __extends(b,a),b.injection=function(){return["$scope","$route",b]},b}(a.BaseController);a.EntityFormWithListController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n,o){a.call(this,b,Static.ControllerArea.Entity,d,e,f,g),this.EntityRepositoryService=h,this.EntityMetadataListCacheService=i,this.EntityModelMapperService=j,this.EntityListCacheService=k,this.LocalizationService=l,this.RedirectService=m,this.DialogService=n,this.DomManipulationService=o;var p=c[Static.RouteParams.EntityName],q=c[Static.RouteParams.EntityId],r=c[Static.RouteParams.PageNumber]||1,s=r-1;this.EntityName=p,this.EntityId=q,this.PageIndex=isNaN(s)?0:s,this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","$routeParams","MessagingService","NotificationService","QueueService","StateService","EntityRepositoryService","EntityMetadataListCacheService","EntityModelMapperService","EntityListCacheService","LocalizationService","RedirectService","DialogService","DomManipulationService",b]},b.prototype.InitializeScope=function(){this.Scope.SubmitButtonText=this.EntityId?this.LocalizationService.Resources.Update:this.LocalizationService.Resources.Create,
this.Scope.SubmitForm=this.SubmitForm.bind(this),this.Scope.FormHeaderIcons=[{Icon:"pencil",Action:this.EditEntitySchema.bind(this),Tooltip:this.LocalizationService.Resources.EditSchema}],this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityData),this.LoadEntityMetadata()},b.prototype.EditEntitySchema=function(){this.RedirectService.RedirectToEditEntitySchema(this.EntityName)},b.prototype.LoadEntityMetadata=function(){this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(this.EntityName,this.LoadEntityMetadataCompleted.bind(this))},b.prototype.LoadEntityMetadataCompleted=function(a,b){if(this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityData),null===b){if(!a)return void this.RedirectService.RedirectToCreateEntitySchema();a.Fields&&a.Fields.length||this.EditEntitySchema(),this.Scope.EntityMetadata=a,this.Scope.FormHeader=this.EntityId?this.LocalizationService.Resources.UpdateExistingRecord.format([a.EntityName]):this.LocalizationService.Resources.CreateNewRecord.format([a.EntityName]),this.LoadEntity()}else this.NotificationService.HandleErrorsModel(b)},b.prototype.LoadEntity=function(){var a=this.StateService.GetEditedEntity(this.EntityName,this.EntityId);if(a)return void this.LoadEntityCompleted(a,null);if(this.EntityId)this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.Entity),this.Scope.Entity=new Models.Entity(this.Scope.EntityMetadata.EntitySystemName),this.EntityRepositoryService.LoadEntity(this.EntityName,this.EntityId,this.LoadEntityCompleted.bind(this));else{var b=new Models.Entity(this.Scope.EntityMetadata.EntitySystemName);this.Scope.OriginalEntity=b,this.Scope.Entity=this.EntityModelMapperService.CloneEntityModel(b),this.StateService.SetEditedEntity(this.Scope.Entity)}},b.prototype.LoadEntityCompleted=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.Entity),null===b?(this.Scope.OriginalEntity=a,this.Scope.Entity=this.EntityModelMapperService.CloneEntityModel(a),this.StateService.SetEditedEntity(this.Scope.Entity),this.Scope.Entity.ValidateAllFields(this.Scope.EntityMetadata)):this.NotificationService.HandleErrorsModel(b)},b.prototype.SubmitForm=function(){var a=this.Scope.Entity;this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntitySubmit),this.EntityRepositoryService.SaveEntity(a,this.SaveEntityCompleted.bind(this))},b.prototype.SaveEntityCompleted=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntitySubmit),null===b?a.ModifiedDate===a.CreatedDate?(this.MessagingService.Messages.Entity.Created.publish(a),this.NotificationService.NotifyMessage(this.LocalizationService.Resources.EntityCreatedSuccess,Static.NotificationSeverity.Success),this.StateService.SetEditedEntity(null),this.LoadEntity()):(this.MessagingService.Messages.Entity.Modified.publish(a),this.QueueService.Queues.NextPage.Notifications.add(this.LocalizationService.Resources.EntityModifiedSuccess,Static.NotificationSeverity.Success),this.RedirectService.RedirectToEntityPage(this.EntityName,null,this.PageIndex+1)):this.NotificationService.HandleErrorsModel(b)},b}(a.BaseViewController);a.EntityFormController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j){a.call(this,b,Static.ControllerArea.Metadata,c,d,e,f),this.EntityRepositoryService=g,this.LocalizationService=h,this.EntityModelMapperService=i,this.RedirectService=j,this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","MessagingService","NotificationService","QueueService","StateService","EntityRepositoryService","LocalizationService","EntityModelMapperService","RedirectService",b]},b.prototype.InitializeScope=function(){this.Scope.FormHeaderIcons=[],this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntitySchemaData),this.CreateEntityMetadata()},b.prototype.CreateEntityMetadata=function(){var a=new Models.Entity(null),b=Data.CreateEntityFormFields.GetData();this.CreateEntityMetadataCompleted(a,b)},b.prototype.CreateEntityMetadataCompleted=function(a,b){this.Scope.Entity=a,this.Scope.EntityMetadata=b,this.Scope.Entity.ValidateAllFields(b),this.Scope.FormHeader=this.LocalizationService.Resources.CreateNewEntity,this.Scope.SubmitButtonText=this.LocalizationService.Resources.Create,this.Scope.SubmitForm=this.SubmitForm.bind(this),this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntitySchemaData)},b.prototype.SubmitForm=function(){var a=this.Scope.Entity,b=this.EntityModelMapperService.MapEntityToEntityMetadataModel(a);this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntitySchemaSubmit),this.EntityRepositoryService.SaveEntityMetadata(b,this.SaveEntityMetadataCompleted.bind(this))},b.prototype.SaveEntityMetadataCompleted=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntitySchemaSubmit),null==b?(this.QueueService.Queues.NextPage.Notifications.add(this.LocalizationService.Resources.MetadataCreatedSuccess,Static.NotificationSeverity.Success),this.MessagingService.Messages.Metadata.Created.publish(a),this.RedirectService.RedirectToEditEntitySchema(a.EntitySystemName)):this.NotificationService.HandleErrorsModel(b)},b}(a.BaseViewController);a.EntityMetadataFormController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n){a.call(this,b,Static.ControllerArea.Metadata,d,e,f,g),this.EntityRepositoryService=h,this.EntityMetadataListCacheService=i,this.LocalizationService=j,this.EntityModelMapperService=k,this.RedirectService=l,this.DialogService=m,this.DomManipulationService=n,this.EntityName=c[Static.RouteParams.EntityName],this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","$routeParams","MessagingService","NotificationService","QueueService","StateService","EntityRepositoryService","EntityMetadataListCacheService","LocalizationService","EntityModelMapperService","RedirectService","DialogService","DomManipulationService",b]},b.prototype.InitializeScope=function(){this.Scope.FormHeaderIcons=[],this.Scope.SaveEntityMetadata=this.SaveEntityMetadata.bind(this),this.AddSubscription(this.MessagingService.Messages.Form.DisplayItem.subscribe(this.DisplayItemMessageReceived.bind(this))),this.AddSubscription(this.MessagingService.Messages.Metadata.Modified.subscribe(this.MetadataChangedHandler.bind(this))),this.CreateFieldMetadata()},b.prototype.CreateFieldMetadata=function(){var a=new Models.Entity(null),b=Data.CreateFieldFormFields.GetData(null);this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.FieldSchemaData),this.CreateFieldMetadataCompleted(a,b)},b.prototype.DisplayItemMessageReceived=function(a){this.CreateFieldMetadataCompleted(a.Data,a.Metadata)},b.prototype.CreateFieldMetadataCompleted=function(a,b){this.Scope.EntityMetadata=b,this.Scope.OriginalEntity=a,this.Scope.Entity=this.EntityModelMapperService.CloneEntityModel(a),this.Scope.Entity.ValidateAllFields(b);var c=function(a){return"FieldTypeName"===a.FieldSystemName},d=b.Fields.single(c);d.ValueChanged=this.FieldTypeChanged.bind(this),this.LoadEntityMetadata()},b.prototype.LoadEntityMetadata=function(){this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(this.EntityName,this.LoadEntityMetadataCompleted.bind(this))},b.prototype.LoadEntityMetadataCompleted=function(a){return a?(this.Scope.OriginalMetadata=a,this.Scope.FormHeader=this.Scope.OriginalEntity.EntitySystemName?this.LocalizationService.Resources.UpdateField:this.LocalizationService.Resources.AddNewField.format([a.EntityName]),this.Scope.SubmitButtonText=this.Scope.OriginalEntity.EntitySystemName?this.LocalizationService.Resources.Update:this.LocalizationService.Resources.Add,this.Scope.SubmitForm=this.SubmitForm.bind(this),void this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.FieldSchemaData)):void this.RedirectService.RedirectToCreateEntitySchema()},b.prototype.FieldTypeChanged=function(a){if(a&&a.Value!==this.Scope.FieldType){this.Scope.FieldType=a.Value;var b=this.Scope.Entity,c=!!this.Scope.OriginalEntity.EntitySystemName,d=Data.CreateFieldFormFields.GetData(a.Value,c);this.CreateFieldMetadataCompleted(b,d)}},b.prototype.SubmitForm=function(){var a=this.Scope.Entity,b=this.EntityModelMapperService.MapEntityModelToFieldMetadata(a),c=this.Scope.OriginalEntity,d=this.Scope.OriginalMetadata,e=function(a){return a.FieldSystemName===b.FieldSystemName},f=d.Fields.single(e),g=c.EntitySystemName!==a.EntitySystemName,h=!(!g||!f);if(!h)if(c.EntitySystemName){this.Scope.FieldModified=!0;var i=function(a){return a.FieldSystemName===c.EntitySystemName},j=d.Fields.single(i);h=!j,!j||g&&f||d.Fields.replace(j,b)}else h=!!f,f||(this.Scope.FieldAdded=!0,d.Fields.push(b));if(h){var k=f?this.LocalizationService.Resources.FieldAlreadyExists:this.LocalizationService.Resources.CouldNotUpdateField;this.NotificationService.NotifyMessage(k,Static.NotificationSeverity.Error)}else this.SaveEntityMetadata(d)},b.prototype.SaveEntityMetadata=function(a){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.FieldSchemaSubmit),this.EntityRepositoryService.SaveEntityMetadata(a,this.SaveEntityMetadataCompleted.bind(this))},b.prototype.SaveEntityMetadataCompleted=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.FieldSchemaSubmit);var c=this.Scope.FieldAdded,d=this.Scope.FieldModified;if(this.Scope.FieldAdded=!1,this.Scope.FieldModified=!1,null===b){this.MessagingService.Messages.Metadata.Modified.publish(a);var e=c?this.LocalizationService.Resources.MetadataFieldCreatedSuccess:this.LocalizationService.Resources.MetadataSavedSuccess;this.NotificationService.NotifyMessage(e,Static.NotificationSeverity.Success),this.Scope.OriginalMetadata=a,(c||d)&&this.CreateFieldMetadata()}else this.NotificationService.HandleErrorsModel(b)},b.prototype.MetadataChangedHandler=function(a){this.Scope.OriginalMetadata.EntitySystemName===a.EntitySystemName&&(this.Scope.OriginalMetadata=a)},b}(a.BaseViewController);a.FieldMetadataFormController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n){a.call(this,b,Static.ControllerArea.Entity,d,e,f,g),this.EntityMetadataListCacheService=h,this.LocalizationService=i,this.RedirectService=j,this.DialogService=k,this.DomManipulationService=l,this.EntityListCacheService=m,this.EntityRepositoryService=n;var o=c[Static.RouteParams.EntityName],p=c[Static.RouteParams.EntityId],q=c[Static.RouteParams.PageNumber]||1,r=q-1;this.EntityName=o,this.EntityId=p,this.PageIndex=isNaN(r)?0:r,this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","$routeParams","MessagingService","NotificationService","QueueService","StateService","EntityMetadataListCacheService","LocalizationService","RedirectService","DialogService","DomManipulationService","EntityListCacheService","EntityRepositoryService",b]},b.prototype.InitializeScope=function(){this.Scope.EntityList=[],this.Scope.ListRecordEdit=this.ListRecordEdit.bind(this),this.Scope.ListRecordDelete=this.ListRecordDelete.bind(this),this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityListMetadata),this.LoadEntityMetadata()},b.prototype.LoadEntityMetadata=function(){this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(this.EntityName,this.LoadEntityMetadataCompleted.bind(this))},b.prototype.LoadEntityMetadataCompleted=function(a,b){if(this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityListMetadata),null==b){if(!a)return void this.RedirectService.RedirectToCreateEntitySchema();this.Scope.ListItemMetadata=a,this.Scope.EmptyListMessage=this.LocalizationService.Resources.NoRecordsOfEntity.format([a.EntityName]),this.Scope.ListHeader=this.LocalizationService.Resources.ListOfRecords.format([a.EntityName]),this.Scope.ListHeaderIcons=[{Icon:"asterisk",Action:this.ListRecordCreate.bind(this),Tooltip:this.LocalizationService.Resources.CreateNewRecord.format([a.EntityName])},{Icon:"filter",Action:this.RedirectToFilteredList.bind(this),Tooltip:this.LocalizationService.Resources.ShowFilteredList}],this.LoadEntityList(),this.AddSubscription(this.MessagingService.Messages.Cache.EntityList.Invalidated.subscribe(this.LoadEntityList.bind(this))),this.AddSubscription(this.MessagingService.Messages.Cache.EntityList.Changed.subscribe(this.LoadEntityList.bind(this)))}else this.NotificationService.HandleErrorsModel(b)},b.prototype.LoadEntityList=function(){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityList),this.EntityListCacheService.LoadEntityListPage(this.EntityName,{},this.PageIndex,this.LoadEntityListCompleted.bind(this))},b.prototype.LoadEntityListCompleted=function(a,b,c,d,e){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityList),null===e?(this.SetPaging(c,d),this.Scope.EntityList=a):(this.SetPaging(c,0),this.NotificationService.HandleErrorsModel(e))},b.prototype.ListRecordEdit=function(a){this.DomManipulationService.ScrollToTop(),this.MessagingService.Messages.Entity.Modify.publish(a),this.RedirectService.RedirectToEntityPage(this.EntityName,a.Id,this.PageIndex+1)},b.prototype.ListRecordCreate=function(){this.RedirectService.RedirectToEntityPage(this.EntityName,null,this.PageIndex+1)},b.prototype.ListRecordDelete=function(a){var b=this;this.DialogService.CreateConfirmationDialog([this.LocalizationService.Resources.DoYouReallyWantToDeleteEntity],function(c){c&&(b.MessagingService.Messages.Entity.Delete.publish(a),b.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityDelete),b.EntityRepositoryService.DeleteEntity(a,b.ListRecordDeleted.bind(b)))})},b.prototype.ListRecordDeleted=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityDelete),null==b?(this.MessagingService.Messages.Entity.Deleted.publish(a),this.NotificationService.NotifyMessage(this.LocalizationService.Resources.EntityDeletedSuccess,Static.NotificationSeverity.Success)):this.NotificationService.HandleErrorsModel(b)},b.prototype.RedirectToFilteredList=function(){this.RedirectService.RedirectToFilteredList(this.EntityName,null,0)},b.prototype.SetPaging=function(a,b){var c=this,d=a+1;this.Scope.Paging={ShowPaging:b>1||d>b&&1!==d||0>d,CanGoFirst:1!==d,CanGoPrevious:d>1,CanGoNext:b>d,CanGoLast:d!==b,CurrentPage:d,SelectedPage:d,TotalPages:b,GoSelected:function(){c.RedirectService.RedirectToEntityPage(c.EntityName,c.EntityId,c.Scope.Paging.SelectedPage)},GoFirst:function(){c.RedirectService.RedirectToEntityPage(c.EntityName,c.EntityId,1)},GoPrevious:function(){c.RedirectService.RedirectToEntityPage(c.EntityName,c.EntityId,d-1)},GoNext:function(){c.RedirectService.RedirectToEntityPage(c.EntityName,c.EntityId,d+1)},GoLast:function(){c.RedirectService.RedirectToEntityPage(c.EntityName,c.EntityId,b)}}},b}(a.BaseListController);a.EntityListController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l){a.call(this,b,Static.ControllerArea.Entity,c,d,e,f),this.RouteParams=g,this.EntityListCacheService=h,this.EntityMetadataListCacheService=i,this.RedirectService=j,this.LocalizationService=k,this.FilterConverterService=l;var m=g[Static.RouteParams.EntityName],n=g[Static.RouteParams.PageNumber],o=n-1;this.EntityName=m,this.PageIndex=isNaN(o)?0:o,this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","MessagingService","NotificationService","QueueService","StateService","$routeParams","EntityListCacheService","EntityMetadataListCacheService","RedirectService","LocalizationService","FilterConverterService",b]},b.prototype.InitializeScope=function(){this.Scope.Search=this.DoFilteredSearch.bind(this),this.LoadEntityMetadata()},b.prototype.LoadEntityMetadata=function(){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.FilteredListMetadata),this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(this.EntityName,this.LoadEntityMetadataCompleted.bind(this))},b.prototype.LoadEntityMetadataCompleted=function(a,b){if(this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.FilteredListMetadata),null==b){if(!a)return void this.RedirectService.RedirectToCreateEntitySchema();this.EntityMetadata=a,this.FilterMetadata=this.FilterConverterService.CreateFilterFormMetadataFromEntityMetadata(a),this.FilterEntity=this.FilterConverterService.ParseFilterQueryString(a,this.RouteParams),this.DatabaseQuery=this.FilterConverterService.CreateDatabaseQueryFromFilter(a,this.FilterEntity),this.FilterQueryString=this.FilterConverterService.CreateFilterQueryString(a,this.FilterEntity),this.Scope.Entity=this.FilterEntity,this.Scope.IsFilterEmpty=Object.isEmpty(this.FilterEntity.Data),this.Scope.IsFilterCollapsed=this.Scope.IsFilterEmpty,this.Scope.EntityMetadata=this.EntityMetadata,this.Scope.FilterMetadata=this.FilterMetadata,this.Scope.EmptyListMessage=this.LocalizationService.Resources.NoRecordsOfFilteredEntity.format([a.EntityName]),this.Scope.ListHeader=this.LocalizationService.Resources.ListOfRecords.format([a.EntityName]),this.LoadEntityList()}else this.NotificationService.HandleErrorsModel(b)},b.prototype.DoFilteredSearch=function(){var a=this.FilterConverterService.CreateFilterQueryString(this.EntityMetadata,this.FilterEntity);this.RedirectService.RedirectToFilteredList(this.EntityName,a,1)},b.prototype.LoadEntityList=function(){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityList),this.EntityListCacheService.LoadEntityListPage(this.EntityName,this.DatabaseQuery,this.PageIndex,this.LoadEntityListCompleted.bind(this))},b.prototype.LoadEntityListCompleted=function(a,b,c,d,e){Object.haveEqualData(this.DatabaseQuery,b)&&(this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityList),null==e?(this.SetPaging(c,d),this.Scope.EntityList=a):(this.SetPaging(c,0),this.NotificationService.HandleErrorsModel(e)))},b.prototype.SetPaging=function(a,b){var c=this,d=a+1;this.Scope.Paging={ShowPaging:b>1||d>b&&1!==d||0>d,CanGoFirst:1!==d,CanGoPrevious:d>1,CanGoNext:b>d,CanGoLast:d!==b,CurrentPage:d,SelectedPage:d,TotalPages:b,GoSelected:function(){c.RedirectService.RedirectToFilteredList(c.EntityName,c.FilterQueryString,c.Scope.Paging.SelectedPage)},GoFirst:function(){c.RedirectService.RedirectToFilteredList(c.EntityName,c.FilterQueryString,1)},GoPrevious:function(){c.RedirectService.RedirectToFilteredList(c.EntityName,c.FilterQueryString,d-1)},GoNext:function(){c.RedirectService.RedirectToFilteredList(c.EntityName,c.FilterQueryString,d+1)},GoLast:function(){c.RedirectService.RedirectToFilteredList(c.EntityName,c.FilterQueryString,b)}}},b}(a.BaseListController);a.EntityListWithFilterController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k,l,m,n){a.call(this,b,Static.ControllerArea.Metadata,d,e,f,g),this.EntityMetadataListCacheService=h,this.LocalizationService=i,this.RedirectService=j,this.EntityModelMapperService=k,this.DialogService=l,this.DomManipulationService=m,this.EntityRepositoryService=n,this.EntityName=c[Static.RouteParams.EntityName],this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","$routeParams","MessagingService","NotificationService","QueueService","StateService","EntityMetadataListCacheService","LocalizationService","RedirectService","EntityModelMapperService","DialogService","DomManipulationService","EntityRepositoryService",b]},b.prototype.InitializeScope=function(){this.Scope.EntityList=[],this.Scope.ListHeaderIcons=[],this.EntityName?(this.Scope.ListRecordEdit=this.ListRecordEdit.bind(this),this.Scope.ListRecordDelete=this.ListRecordDelete.bind(this),this.Scope.SaveEntityMetadata=this.SaveEntityMetadata.bind(this),this.Scope.ListItemMetadata=Data.CreateFieldFormFields.GetData(null),this.AddSubscription(this.MessagingService.Messages.Metadata.Modified.subscribe(this.LoadEntityMetadata.bind(this))),this.AddSubscription(this.MessagingService.Messages.Metadata.Modified.subscribe(this.MetadataChangedHandler.bind(this))),this.LoadEntityMetadata()):(this.Scope.EmptyListMessage=this.LocalizationService.Resources.NoFieldsInNewEntity,this.Scope.ListHeader=this.LocalizationService.Resources.ListOfEntityFields)},b.prototype.LoadEntityMetadata=function(){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.FieldListMetadata),this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(this.EntityName,this.LoadEntityMetadataCompleted.bind(this))},b.prototype.LoadEntityMetadataCompleted=function(a){return a?(this.Scope.OriginalMetadata=a,this.Scope.EntityList=this.EntityModelMapperService.MapFieldsMetadataToEntityModels(a.Fields),this.Scope.EmptyListMessage=this.LocalizationService.Resources.NoFieldsInEntity.format([a.EntityName]),this.Scope.ListHeader=this.LocalizationService.Resources.ListOfEntityFields,this.Scope.ListHeaderIcons=[{Icon:"asterisk",Action:this.ListRecordCreate.bind(this),Tooltip:this.LocalizationService.Resources.CreateNewField}],a.Fields.length&&this.Scope.ListHeaderIcons.push({Icon:"th-list",Action:this.RedirectToEntityList.bind(this),Tooltip:this.LocalizationService.Resources.ShowListOf.format([a.EntityName])}),void this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.FieldListMetadata)):void this.RedirectService.RedirectToCreateEntitySchema()},b.prototype.ListRecordEdit=function(a){this.DomManipulationService.ScrollToTop(),this.Scope.FieldType=a.Data.FieldTypeName.Value;var b=Data.CreateFieldFormFields.GetData(this.Scope.FieldType,!0);this.MessagingService.Messages.Form.DisplayItem.publish(a,b)},b.prototype.ListRecordCreate=function(){var a=new Models.Entity(null),b=Data.CreateFieldFormFields.GetData(null);this.MessagingService.Messages.Form.DisplayItem.publish(a,b)},b.prototype.ListRecordDelete=function(a){var b=this;this.DialogService.CreateConfirmationDialog([this.LocalizationService.Resources.DoYouReallyWantToDeleteMetadataField],function(c){if(c){var d=b.Scope.OriginalMetadata,e=function(b){return b.FieldSystemName===a.EntitySystemName},f=d.Fields.single(e);f&&(d.Fields.remove(f),b.SaveEntityMetadata(d))}})},b.prototype.SaveEntityMetadata=function(a){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.FieldSchemaSubmit),this.EntityRepositoryService.SaveEntityMetadata(a,this.SaveEntityMetadataCompleted.bind(this))},b.prototype.SaveEntityMetadataCompleted=function(a,b){if(this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.FieldSchemaSubmit),null===b){this.MessagingService.Messages.Metadata.Modified.publish(a);var c=this.LocalizationService.Resources.MetadataSavedSuccess;this.NotificationService.NotifyMessage(c,Static.NotificationSeverity.Success)}else this.NotificationService.HandleErrorsModel(b)},b.prototype.MetadataChangedHandler=function(a){this.Scope.OriginalMetadata.EntitySystemName===a.EntitySystemName&&this.LoadEntityMetadataCompleted(a)},b.prototype.RedirectToEntityList=function(){this.RedirectService.RedirectToCreateEntity(this.Scope.OriginalMetadata.EntitySystemName)},b}(a.BaseListController);a.FieldMetadataListController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c){a.call(this,b)}return __extends(b,a),b.injection=function(){return["$scope","$route",b]},b}(a.BaseController);a.DashboardController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i,j,k){a.call(this,b,Static.ControllerArea.Dashboard,d,e,f,g),this.EntityMetadataListCacheService=h,this.LocalizationService=i,this.RedirectService=j,this.DashboardRepositoryService=k;var l=c[Static.RouteParams.EntityName];this.EntityName=l,this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","$routeParams","MessagingService","NotificationService","QueueService","StateService","EntityMetadataListCacheService","LocalizationService","RedirectService","DashboardRepositoryService",b]},b.prototype.InitializeScope=function(){this.EntityName?this.LoadEntityMetadata():(this.Scope.FormHeader=this.LocalizationService.Resources.Dashboard,this.Scope.RecentActivityHeader=this.LocalizationService.Resources.RecentActivity),this.LoadDashboardData()},b.prototype.LoadEntityMetadata=function(){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.EntityData),this.EntityMetadataListCacheService.LoadEntityMetadataFromCache(this.EntityName,this.LoadEntityMetadataCompleted.bind(this))},b.prototype.LoadEntityMetadataCompleted=function(a,b){if(this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.EntityData),null===b){if(!a)return void this.RedirectService.RedirectToCreateEntitySchema();this.Scope.EntityMetadata=a,this.Scope.FormHeader=this.LocalizationService.Resources.DashboardFor.format([a.EntityName])}else this.NotificationService.HandleErrorsModel(b)},b.prototype.LoadDashboardData=function(){this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.DashboardSummary),this.DashboardRepositoryService.GetActivitySummary(this.EntityName,this.ActivitySummaryLoaded.bind(this))},b.prototype.ActivitySummaryLoaded=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.DashboardSummary),null===b?(this.Scope.NoRecentActivityMessage=this.LocalizationService.Resources.NoRecentActivity,this.Scope.ActivitySummary=a):this.NotificationService.HandleErrorsModel(b)},b}(a.BaseViewController);a.DashboardActivitySummaryController=b}(Controllers||(Controllers={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Controllers;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i){a.call(this,b,Static.ControllerArea.Dashboard,d,e,f,g),this.LocalizationService=h,this.DashboardRepositoryService=i,this.EntityName=c[Static.RouteParams.EntityName],this.InitializeScope()}return __extends(b,a),b.injection=function(){return["$scope","$routeParams","MessagingService","NotificationService","QueueService","StateService","LocalizationService","DashboardRepositoryService",b]},b.prototype.InitializeScope=function(){this.Scope.NoRecentActivityMessage=this.LocalizationService.Resources.NoRecentActivity,this.Scope.ActivityLists=[{Title:this.LocalizationService.Resources.LastModifiedRecordsByMe,Type:"me"},{Title:this.LocalizationService.Resources.LastModifiedRecords,Type:"all"}],this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.DashboardMyActivity),this.MessagingService.Messages.Loading.Started.publish(Static.LoadingType.DashboardActivity),this.DashboardRepositoryService.GetMyLastActivity(this.EntityName,this.MyLastActivityLoaded.bind(this)),this.DashboardRepositoryService.GetLastActivity(this.EntityName,this.LastActivityLoaded.bind(this))},b.prototype.MyLastActivityLoaded=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.DashboardMyActivity),null===b?this.Scope.ActivityLists[0].Items=a:this.NotificationService.HandleErrorsModel(b)},b.prototype.LastActivityLoaded=function(a,b){this.MessagingService.Messages.Loading.Finished.publish(Static.LoadingType.DashboardActivity),null===b?this.Scope.ActivityLists[1].Items=a:this.NotificationService.HandleErrorsModel(b)},b}(a.BaseViewController);a.DashboardActivityListController=b}(Controllers||(Controllers={}));var Config;!function(a){var b=function(){function a(){}return a.injection=function(){return["$routeProvider",a.InitializeRoutes]},a.InitializeRoutes=function(b){a.InitializeDashboardRoutes(b),a.InitializeMetadataRoutes(b),a.InitializeEntityRoutes(b),a.InitializeOtherRoutes(b)},a.InitializeDashboardRoutes=function(a){return a.when("/dashboard/:_entityName",{templateUrl:"angular/views/dashboard.html",controller:"DashboardController"}).when("/dashboard",{templateUrl:"angular/views/dashboard.html",controller:"DashboardController"})},a.InitializeMetadataRoutes=function(a){return a.when("/schema/entity/:_entityName",{templateUrl:"angular/views/entityFormWithList.html",controller:"EntityFormWithListController",data:{metadata:!0,create:!1}}).when("/schema/entity",{templateUrl:"angular/views/entityFormWithList.html",controller:"EntityFormWithListController",data:{metadata:!0,create:!0}})},a.InitializeEntityRoutes=function(a){return a.when("/entity/:_entityName/filteredlist/page/:_pageNumber",{templateUrl:"angular/views/entityListWithFilter.html",controller:"EntityListWithFilterController",data:{metadata:!1,create:!1}}).when("/entity/:_entityName/filteredlist",{templateUrl:"angular/views/entityListWithFilter.html",controller:"EntityListWithFilterController",data:{metadata:!1,create:!1}}).when("/entity/:_entityName/page/:_pageNumber/id/:_entityId",{templateUrl:"angular/views/entityFormWithList.html",controller:"EntityFormWithListController",data:{metadata:!1,create:!1}}).when("/entity/:_entityName/page/:_pageNumber",{templateUrl:"angular/views/entityFormWithList.html",controller:"EntityFormWithListController",data:{metadata:!1,create:!0}}).when("/entity/:_entityName/id/:_entityId",{templateUrl:"angular/views/entityFormWithList.html",controller:"EntityFormWithListController",data:{metadata:!1,create:!1}}).when("/entity/:_entityName",{templateUrl:"angular/views/entityFormWithList.html",controller:"EntityFormWithListController",data:{metadata:!1,create:!0}})},a.InitializeOtherRoutes=function(a){a.otherwise({redirectTo:"/dashboard"})},a}();a.Router=b}(Config||(Config={}));var _global=this;_global.BootstrapScripts=_global.BootstrapScripts||[];var AngularApplication;!function(a){var b=function(){function a(){}return a.Start=function(){var a=angular.module("BerryFormsApp",["ngRoute","ui.bootstrap.datepicker","ui.sortable","toaster"]);a.config(Config.Router.injection()),a.factory("$exceptionHandler",Interceptors.ExceptionHandler.injection()),a.directive("leftMenuAutosize",Directives.LeftMenuAutosize.injection()),a.directive("systemSymbol",Directives.SystemSymbol.injection()),a.directive("fieldComponentCreator",Directives.FieldComponentCreator.injection()),a.directive("dashboardActivityItemChart",Directives.DashboardActivityItemChart.injection()),a.service("MessagingService",Services.MessagingService.injection()),a.service("QueueService",Services.QueueService.injection()),a.service("NamingConventionsService",Services.NamingConventionsService.injection()),a.service("EntityModelMapperService",Services.EntityModelMapperService.injection()),a.service("FilterConverterService",Services.FilterConverterService.injection()),
a.service("RedirectService",Services.RedirectService.injection()),a.service("LocalizationService",Services.LocalizationService.injection()),a.service("HttpWrapperService",Services.HttpWrapperService.injection()),a.service("EntityRepositoryService",Services.EntityRepositoryService.injection()),a.service("UserRepositoryService",Services.UserRepositoryService.injection()),a.service("DashboardRepositoryService",Services.DashboardRepositoryService.injection()),a.service("UrlLocatorService",Services.UrlLocatorService.injection()),a.service("NotificationService",Services.NotificationService.injection()),a.service("EntityMetadataListCacheService",Services.EntityMetadataListCacheService.injection()),a.service("EntityListCacheService",Services.EntityListCacheService.injection()),a.service("PersistentStorageService",Services.PersistentStorageService.injection()),a.service("StateService",Services.StateService.injection()),a.service("DialogService",Services.DialogService.injection()),a.service("DomManipulationService",Services.DomManipulationService.injection()),a.service("QueryCreatorService",Services.QueryCreatorService.injection()),a.service("PluginsExecutorService",Services.PluginsExecutorService.injection()),a.service("PermissionService",Services.PermissionService.injection()),a.controller("MenuController",Controllers.MenuController.injection()),a.controller("LoginController",Controllers.LoginController.injection()),a.controller("LoadingController",Controllers.LoadingController.injection()),a.controller("DialogController",Controllers.DialogController.injection()),a.controller("NotificationController",Controllers.NotificationController.injection()),a.controller("EntityFormWithListController",Controllers.EntityFormWithListController.injection()),a.controller("EntityFormController",Controllers.EntityFormController.injection()),a.controller("EntityMetadataFormController",Controllers.EntityMetadataFormController.injection()),a.controller("FieldMetadataFormController",Controllers.FieldMetadataFormController.injection()),a.controller("EntityListController",Controllers.EntityListController.injection()),a.controller("EntityListWithFilterController",Controllers.EntityListWithFilterController.injection()),a.controller("FieldMetadataListController",Controllers.FieldMetadataListController.injection()),a.controller("DashboardController",Controllers.DashboardController.injection()),a.controller("DashboardActivitySummaryController",Controllers.DashboardActivitySummaryController.injection()),a.controller("DashboardActivityListController",Controllers.DashboardActivityListController.injection()),a.service("FieldTypesRegistry",Components.FieldTypes.FieldTypesRegistry.injection()),angular.forEach(_global.Components.FieldTypes,function(b){a.directive(b.DirectiveName,b.DirectiveOptions()),a.controller(b.DirectiveControllerName,b.DirectiveControllerOptions())});for(var b=0;b<_global.BootstrapScripts.length;b++){var c=_global.BootstrapScripts[b];c(angular)}angular.bootstrap(document,["BerryFormsApp"]),document.body.className+=" ng-app"},a}();!function(){Helpers.ResourceLoader.LoadRemainingResources(b.Start)}()}(AngularApplication||(AngularApplication={}));